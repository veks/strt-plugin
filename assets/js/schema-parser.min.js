!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory((global="undefined"!=typeof globalThis?globalThis:global||self).SchemaParser={})}(this,function(exports){"use strict";function getDefaultExportFromCjs(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var hasRequiredCode$1,ajv$1={exports:{}},core$1={},validate={},boolSchema={},errors={},codegen={},code$1={};function requireCode$1(){return hasRequiredCode$1||(hasRequiredCode$1=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.regexpCode=exports.getEsmExportName=exports.getProperty=exports.safeStringify=exports.stringify=exports.strConcat=exports.addCodeArg=exports.str=exports._=exports.nil=exports._Code=exports.Name=exports.IDENTIFIER=exports._CodeOrName=void 0;class _CodeOrName{}exports._CodeOrName=_CodeOrName,exports.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class Name extends _CodeOrName{constructor(s){if(super(),!exports.IDENTIFIER.test(s))throw new Error("CodeGen: name must be a valid identifier");this.str=s}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}exports.Name=Name;class _Code extends _CodeOrName{constructor(code){super(),this._items="string"==typeof code?[code]:code}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const item=this._items[0];return""===item||'""'===item}get str(){var _a;return null!==(_a=this._str)&&void 0!==_a?_a:this._str=this._items.reduce((s,c)=>`${s}${c}`,"")}get names(){var _a;return null!==(_a=this._names)&&void 0!==_a?_a:this._names=this._items.reduce((names,c)=>(c instanceof Name&&(names[c.str]=(names[c.str]||0)+1),names),{})}}function _(strs,...args){const code=[strs[0]];let i=0;for(;i<args.length;)addCodeArg(code,args[i]),code.push(strs[++i]);return new _Code(code)}exports._Code=_Code,exports.nil=new _Code(""),exports._=_;const plus=new _Code("+");function str(strs,...args){const expr=[safeStringify(strs[0])];let i=0;for(;i<args.length;)expr.push(plus),addCodeArg(expr,args[i]),expr.push(plus,safeStringify(strs[++i]));return function(expr){let i=1;for(;i<expr.length-1;){if(expr[i]===plus){const res=mergeExprItems(expr[i-1],expr[i+1]);if(void 0!==res){expr.splice(i-1,3,res);continue}expr[i++]="+"}i++}}(expr),new _Code(expr)}function addCodeArg(code,arg){var x;arg instanceof _Code?code.push(...arg._items):arg instanceof Name?code.push(arg):code.push("number"==typeof(x=arg)||"boolean"==typeof x||null===x?x:safeStringify(Array.isArray(x)?x.join(","):x))}function mergeExprItems(a,b){if('""'===b)return a;if('""'===a)return b;if("string"==typeof a){if(b instanceof Name||'"'!==a[a.length-1])return;return"string"!=typeof b?`${a.slice(0,-1)}${b}"`:'"'===b[0]?a.slice(0,-1)+b.slice(1):void 0}return"string"!=typeof b||'"'!==b[0]||a instanceof Name?void 0:`"${a}${b.slice(1)}`}function safeStringify(x){return JSON.stringify(x).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}exports.str=str,exports.addCodeArg=addCodeArg,exports.strConcat=function(c1,c2){return c2.emptyStr()?c1:c1.emptyStr()?c2:str`${c1}${c2}`},exports.stringify=function(x){return new _Code(safeStringify(x))},exports.safeStringify=safeStringify,exports.getProperty=function(key){return"string"==typeof key&&exports.IDENTIFIER.test(key)?new _Code(`.${key}`):_`[${key}]`},exports.getEsmExportName=function(key){if("string"==typeof key&&exports.IDENTIFIER.test(key))return new _Code(`${key}`);throw new Error(`CodeGen: invalid export name: ${key}, use explicit $id name mapping`)},exports.regexpCode=function(rx){return new _Code(rx.toString())}}(code$1)),code$1}var hasRequiredScope,hasRequiredCodegen,scope={};function requireScope(){return hasRequiredScope||(hasRequiredScope=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.ValueScope=exports.ValueScopeName=exports.Scope=exports.varKinds=exports.UsedValueState=void 0;const code_1=requireCode$1();class ValueError extends Error{constructor(name){super(`CodeGen: "code" for ${name} not defined`),this.value=name.value}}var UsedValueState;!function(UsedValueState){UsedValueState[UsedValueState.Started=0]="Started",UsedValueState[UsedValueState.Completed=1]="Completed"}(UsedValueState||(exports.UsedValueState=UsedValueState={})),exports.varKinds={const:new code_1.Name("const"),let:new code_1.Name("let"),var:new code_1.Name("var")};class Scope{constructor({prefixes:prefixes,parent:parent}={}){this._names={},this._prefixes=prefixes,this._parent=parent}toName(nameOrPrefix){return nameOrPrefix instanceof code_1.Name?nameOrPrefix:this.name(nameOrPrefix)}name(prefix){return new code_1.Name(this._newName(prefix))}_newName(prefix){return`${prefix}${(this._names[prefix]||this._nameGroup(prefix)).index++}`}_nameGroup(prefix){var _a,_b;if((null===(_b=null===(_a=this._parent)||void 0===_a?void 0:_a._prefixes)||void 0===_b?void 0:_b.has(prefix))||this._prefixes&&!this._prefixes.has(prefix))throw new Error(`CodeGen: prefix "${prefix}" is not allowed in this scope`);return this._names[prefix]={prefix:prefix,index:0}}}exports.Scope=Scope;class ValueScopeName extends code_1.Name{constructor(prefix,nameStr){super(nameStr),this.prefix=prefix}setValue(value,{property:property,itemIndex:itemIndex}){this.value=value,this.scopePath=code_1._`.${new code_1.Name(property)}[${itemIndex}]`}}exports.ValueScopeName=ValueScopeName;const line=code_1._`\n`;exports.ValueScope=class extends Scope{constructor(opts){super(opts),this._values={},this._scope=opts.scope,this.opts={...opts,_n:opts.lines?line:code_1.nil}}get(){return this._scope}name(prefix){return new ValueScopeName(prefix,this._newName(prefix))}value(nameOrPrefix,value){var _a;if(void 0===value.ref)throw new Error("CodeGen: ref must be passed in value");const name=this.toName(nameOrPrefix),{prefix:prefix}=name,valueKey=null!==(_a=value.key)&&void 0!==_a?_a:value.ref;let vs=this._values[prefix];if(vs){const _name=vs.get(valueKey);if(_name)return _name}else vs=this._values[prefix]=new Map;vs.set(valueKey,name);const s=this._scope[prefix]||(this._scope[prefix]=[]),itemIndex=s.length;return s[itemIndex]=value.ref,name.setValue(value,{property:prefix,itemIndex:itemIndex}),name}getValue(prefix,keyOrRef){const vs=this._values[prefix];if(vs)return vs.get(keyOrRef)}scopeRefs(scopeName,values=this._values){return this._reduceValues(values,name=>{if(void 0===name.scopePath)throw new Error(`CodeGen: name "${name}" has no value`);return code_1._`${scopeName}${name.scopePath}`})}scopeCode(values=this._values,usedValues,getCode){return this._reduceValues(values,name=>{if(void 0===name.value)throw new Error(`CodeGen: name "${name}" has no value`);return name.value.code},usedValues,getCode)}_reduceValues(values,valueCode,usedValues={},getCode){let code=code_1.nil;for(const prefix in values){const vs=values[prefix];if(!vs)continue;const nameSet=usedValues[prefix]=usedValues[prefix]||new Map;vs.forEach(name=>{if(nameSet.has(name))return;nameSet.set(name,UsedValueState.Started);let c=valueCode(name);if(c){const def=this.opts.es5?exports.varKinds.var:exports.varKinds.const;code=code_1._`${code}${def} ${name} = ${c};${this.opts._n}`}else{if(!(c=null==getCode?void 0:getCode(name)))throw new ValueError(name);code=code_1._`${code}${c}${this.opts._n}`}nameSet.set(name,UsedValueState.Completed)})}return code}}}(scope)),scope}function requireCodegen(){return hasRequiredCodegen||(hasRequiredCodegen=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.or=exports.and=exports.not=exports.CodeGen=exports.operators=exports.varKinds=exports.ValueScopeName=exports.ValueScope=exports.Scope=exports.Name=exports.regexpCode=exports.stringify=exports.getProperty=exports.nil=exports.strConcat=exports.str=exports._=void 0;const code_1=requireCode$1(),scope_1=requireScope();var code_2=requireCode$1();Object.defineProperty(exports,"_",{enumerable:!0,get:function(){return code_2._}}),Object.defineProperty(exports,"str",{enumerable:!0,get:function(){return code_2.str}}),Object.defineProperty(exports,"strConcat",{enumerable:!0,get:function(){return code_2.strConcat}}),Object.defineProperty(exports,"nil",{enumerable:!0,get:function(){return code_2.nil}}),Object.defineProperty(exports,"getProperty",{enumerable:!0,get:function(){return code_2.getProperty}}),Object.defineProperty(exports,"stringify",{enumerable:!0,get:function(){return code_2.stringify}}),Object.defineProperty(exports,"regexpCode",{enumerable:!0,get:function(){return code_2.regexpCode}}),Object.defineProperty(exports,"Name",{enumerable:!0,get:function(){return code_2.Name}});var scope_2=requireScope();Object.defineProperty(exports,"Scope",{enumerable:!0,get:function(){return scope_2.Scope}}),Object.defineProperty(exports,"ValueScope",{enumerable:!0,get:function(){return scope_2.ValueScope}}),Object.defineProperty(exports,"ValueScopeName",{enumerable:!0,get:function(){return scope_2.ValueScopeName}}),Object.defineProperty(exports,"varKinds",{enumerable:!0,get:function(){return scope_2.varKinds}}),exports.operators={GT:new code_1._Code(">"),GTE:new code_1._Code(">="),LT:new code_1._Code("<"),LTE:new code_1._Code("<="),EQ:new code_1._Code("==="),NEQ:new code_1._Code("!=="),NOT:new code_1._Code("!"),OR:new code_1._Code("||"),AND:new code_1._Code("&&"),ADD:new code_1._Code("+")};class Node{optimizeNodes(){return this}optimizeNames(_names,_constants){return this}}class Def extends Node{constructor(varKind,name,rhs){super(),this.varKind=varKind,this.name=name,this.rhs=rhs}render({es5:es5,_n:_n}){const varKind=es5?scope_1.varKinds.var:this.varKind,rhs=void 0===this.rhs?"":` = ${this.rhs}`;return`${varKind} ${this.name}${rhs};`+_n}optimizeNames(names,constants){if(names[this.name.str])return this.rhs&&(this.rhs=optimizeExpr(this.rhs,names,constants)),this}get names(){return this.rhs instanceof code_1._CodeOrName?this.rhs.names:{}}}class Assign extends Node{constructor(lhs,rhs,sideEffects){super(),this.lhs=lhs,this.rhs=rhs,this.sideEffects=sideEffects}render({_n:_n}){return`${this.lhs} = ${this.rhs};`+_n}optimizeNames(names,constants){if(!(this.lhs instanceof code_1.Name)||names[this.lhs.str]||this.sideEffects)return this.rhs=optimizeExpr(this.rhs,names,constants),this}get names(){return addExprNames(this.lhs instanceof code_1.Name?{}:{...this.lhs.names},this.rhs)}}class AssignOp extends Assign{constructor(lhs,op,rhs,sideEffects){super(lhs,rhs,sideEffects),this.op=op}render({_n:_n}){return`${this.lhs} ${this.op}= ${this.rhs};`+_n}}class Label extends Node{constructor(label){super(),this.label=label,this.names={}}render({_n:_n}){return`${this.label}:`+_n}}class Break extends Node{constructor(label){super(),this.label=label,this.names={}}render({_n:_n}){return`break${this.label?` ${this.label}`:""};`+_n}}class Throw extends Node{constructor(error){super(),this.error=error}render({_n:_n}){return`throw ${this.error};`+_n}get names(){return this.error.names}}class AnyCode extends Node{constructor(code){super(),this.code=code}render({_n:_n}){return`${this.code};`+_n}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(names,constants){return this.code=optimizeExpr(this.code,names,constants),this}get names(){return this.code instanceof code_1._CodeOrName?this.code.names:{}}}class ParentNode extends Node{constructor(nodes=[]){super(),this.nodes=nodes}render(opts){return this.nodes.reduce((code,n)=>code+n.render(opts),"")}optimizeNodes(){const{nodes:nodes}=this;let i=nodes.length;for(;i--;){const n=nodes[i].optimizeNodes();Array.isArray(n)?nodes.splice(i,1,...n):n?nodes[i]=n:nodes.splice(i,1)}return nodes.length>0?this:void 0}optimizeNames(names,constants){const{nodes:nodes}=this;let i=nodes.length;for(;i--;){const n=nodes[i];n.optimizeNames(names,constants)||(subtractNames(names,n.names),nodes.splice(i,1))}return nodes.length>0?this:void 0}get names(){return this.nodes.reduce((names,n)=>addNames(names,n.names),{})}}class BlockNode extends ParentNode{render(opts){return"{"+opts._n+super.render(opts)+"}"+opts._n}}class Root extends ParentNode{}class Else extends BlockNode{}Else.kind="else";class If extends BlockNode{constructor(condition,nodes){super(nodes),this.condition=condition}render(opts){let code=`if(${this.condition})`+super.render(opts);return this.else&&(code+="else "+this.else.render(opts)),code}optimizeNodes(){super.optimizeNodes();const cond=this.condition;if(!0===cond)return this.nodes;let e=this.else;if(e){const ns=e.optimizeNodes();e=this.else=Array.isArray(ns)?new Else(ns):ns}return e?!1===cond?e instanceof If?e:e.nodes:this.nodes.length?this:new If(not(cond),e instanceof If?[e]:e.nodes):!1!==cond&&this.nodes.length?this:void 0}optimizeNames(names,constants){var _a;if(this.else=null===(_a=this.else)||void 0===_a?void 0:_a.optimizeNames(names,constants),super.optimizeNames(names,constants)||this.else)return this.condition=optimizeExpr(this.condition,names,constants),this}get names(){const names=super.names;return addExprNames(names,this.condition),this.else&&addNames(names,this.else.names),names}}If.kind="if";class For extends BlockNode{}For.kind="for";class ForLoop extends For{constructor(iteration){super(),this.iteration=iteration}render(opts){return`for(${this.iteration})`+super.render(opts)}optimizeNames(names,constants){if(super.optimizeNames(names,constants))return this.iteration=optimizeExpr(this.iteration,names,constants),this}get names(){return addNames(super.names,this.iteration.names)}}class ForRange extends For{constructor(varKind,name,from,to){super(),this.varKind=varKind,this.name=name,this.from=from,this.to=to}render(opts){const varKind=opts.es5?scope_1.varKinds.var:this.varKind,{name:name,from:from,to:to}=this;return`for(${varKind} ${name}=${from}; ${name}<${to}; ${name}++)`+super.render(opts)}get names(){const names=addExprNames(super.names,this.from);return addExprNames(names,this.to)}}class ForIter extends For{constructor(loop,varKind,name,iterable){super(),this.loop=loop,this.varKind=varKind,this.name=name,this.iterable=iterable}render(opts){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(opts)}optimizeNames(names,constants){if(super.optimizeNames(names,constants))return this.iterable=optimizeExpr(this.iterable,names,constants),this}get names(){return addNames(super.names,this.iterable.names)}}class Func extends BlockNode{constructor(name,args,async){super(),this.name=name,this.args=args,this.async=async}render(opts){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(opts)}}Func.kind="func";class Return extends ParentNode{render(opts){return"return "+super.render(opts)}}Return.kind="return";class Try extends BlockNode{render(opts){let code="try"+super.render(opts);return this.catch&&(code+=this.catch.render(opts)),this.finally&&(code+=this.finally.render(opts)),code}optimizeNodes(){var _a,_b;return super.optimizeNodes(),null===(_a=this.catch)||void 0===_a||_a.optimizeNodes(),null===(_b=this.finally)||void 0===_b||_b.optimizeNodes(),this}optimizeNames(names,constants){var _a,_b;return super.optimizeNames(names,constants),null===(_a=this.catch)||void 0===_a||_a.optimizeNames(names,constants),null===(_b=this.finally)||void 0===_b||_b.optimizeNames(names,constants),this}get names(){const names=super.names;return this.catch&&addNames(names,this.catch.names),this.finally&&addNames(names,this.finally.names),names}}class Catch extends BlockNode{constructor(error){super(),this.error=error}render(opts){return`catch(${this.error})`+super.render(opts)}}Catch.kind="catch";class Finally extends BlockNode{render(opts){return"finally"+super.render(opts)}}function addNames(names,from){for(const n in from)names[n]=(names[n]||0)+(from[n]||0);return names}function addExprNames(names,from){return from instanceof code_1._CodeOrName?addNames(names,from.names):names}function optimizeExpr(expr,names,constants){return expr instanceof code_1.Name?replaceName(expr):(e=expr)instanceof code_1._Code&&e._items.some(c=>c instanceof code_1.Name&&1===names[c.str]&&void 0!==constants[c.str])?new code_1._Code(expr._items.reduce((items,c)=>(c instanceof code_1.Name&&(c=replaceName(c)),c instanceof code_1._Code?items.push(...c._items):items.push(c),items),[])):expr;var e;function replaceName(n){const c=constants[n.str];return void 0===c||1!==names[n.str]?n:(delete names[n.str],c)}}function subtractNames(names,from){for(const n in from)names[n]=(names[n]||0)-(from[n]||0)}function not(x){return"boolean"==typeof x||"number"==typeof x||null===x?!x:code_1._`!${par(x)}`}Finally.kind="finally",exports.CodeGen=class{constructor(extScope,opts={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...opts,_n:opts.lines?"\n":""},this._extScope=extScope,this._scope=new scope_1.Scope({parent:extScope}),this._nodes=[new Root]}toString(){return this._root.render(this.opts)}name(prefix){return this._scope.name(prefix)}scopeName(prefix){return this._extScope.name(prefix)}scopeValue(prefixOrName,value){const name=this._extScope.value(prefixOrName,value);return(this._values[name.prefix]||(this._values[name.prefix]=new Set)).add(name),name}getScopeValue(prefix,keyOrRef){return this._extScope.getValue(prefix,keyOrRef)}scopeRefs(scopeName){return this._extScope.scopeRefs(scopeName,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(varKind,nameOrPrefix,rhs,constant){const name=this._scope.toName(nameOrPrefix);return void 0!==rhs&&constant&&(this._constants[name.str]=rhs),this._leafNode(new Def(varKind,name,rhs)),name}const(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.const,nameOrPrefix,rhs,_constant)}let(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.let,nameOrPrefix,rhs,_constant)}var(nameOrPrefix,rhs,_constant){return this._def(scope_1.varKinds.var,nameOrPrefix,rhs,_constant)}assign(lhs,rhs,sideEffects){return this._leafNode(new Assign(lhs,rhs,sideEffects))}add(lhs,rhs){return this._leafNode(new AssignOp(lhs,exports.operators.ADD,rhs))}code(c){return"function"==typeof c?c():c!==code_1.nil&&this._leafNode(new AnyCode(c)),this}object(...keyValues){const code=["{"];for(const[key,value]of keyValues)code.length>1&&code.push(","),code.push(key),(key!==value||this.opts.es5)&&(code.push(":"),(0,code_1.addCodeArg)(code,value));return code.push("}"),new code_1._Code(code)}if(condition,thenBody,elseBody){if(this._blockNode(new If(condition)),thenBody&&elseBody)this.code(thenBody).else().code(elseBody).endIf();else if(thenBody)this.code(thenBody).endIf();else if(elseBody)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(condition){return this._elseNode(new If(condition))}else(){return this._elseNode(new Else)}endIf(){return this._endBlockNode(If,Else)}_for(node,forBody){return this._blockNode(node),forBody&&this.code(forBody).endFor(),this}for(iteration,forBody){return this._for(new ForLoop(iteration),forBody)}forRange(nameOrPrefix,from,to,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.let)){const name=this._scope.toName(nameOrPrefix);return this._for(new ForRange(varKind,name,from,to),()=>forBody(name))}forOf(nameOrPrefix,iterable,forBody,varKind=scope_1.varKinds.const){const name=this._scope.toName(nameOrPrefix);if(this.opts.es5){const arr=iterable instanceof code_1.Name?iterable:this.var("_arr",iterable);return this.forRange("_i",0,code_1._`${arr}.length`,i=>{this.var(name,code_1._`${arr}[${i}]`),forBody(name)})}return this._for(new ForIter("of",varKind,name,iterable),()=>forBody(name))}forIn(nameOrPrefix,obj,forBody,varKind=(this.opts.es5?scope_1.varKinds.var:scope_1.varKinds.const)){if(this.opts.ownProperties)return this.forOf(nameOrPrefix,code_1._`Object.keys(${obj})`,forBody);const name=this._scope.toName(nameOrPrefix);return this._for(new ForIter("in",varKind,name,obj),()=>forBody(name))}endFor(){return this._endBlockNode(For)}label(label){return this._leafNode(new Label(label))}break(label){return this._leafNode(new Break(label))}return(value){const node=new Return;if(this._blockNode(node),this.code(value),1!==node.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Return)}try(tryBody,catchCode,finallyCode){if(!catchCode&&!finallyCode)throw new Error('CodeGen: "try" without "catch" and "finally"');const node=new Try;if(this._blockNode(node),this.code(tryBody),catchCode){const error=this.name("e");this._currNode=node.catch=new Catch(error),catchCode(error)}return finallyCode&&(this._currNode=node.finally=new Finally,this.code(finallyCode)),this._endBlockNode(Catch,Finally)}throw(error){return this._leafNode(new Throw(error))}block(body,nodeCount){return this._blockStarts.push(this._nodes.length),body&&this.code(body).endBlock(nodeCount),this}endBlock(nodeCount){const len=this._blockStarts.pop();if(void 0===len)throw new Error("CodeGen: not in self-balancing block");const toClose=this._nodes.length-len;if(toClose<0||void 0!==nodeCount&&toClose!==nodeCount)throw new Error(`CodeGen: wrong number of nodes: ${toClose} vs ${nodeCount} expected`);return this._nodes.length=len,this}func(name,args=code_1.nil,async,funcBody){return this._blockNode(new Func(name,args,async)),funcBody&&this.code(funcBody).endFunc(),this}endFunc(){return this._endBlockNode(Func)}optimize(n=1){for(;n-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(node){return this._currNode.nodes.push(node),this}_blockNode(node){this._currNode.nodes.push(node),this._nodes.push(node)}_endBlockNode(N1,N2){const n=this._currNode;if(n instanceof N1||N2&&n instanceof N2)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${N2?`${N1.kind}/${N2.kind}`:N1.kind}"`)}_elseNode(node){const n=this._currNode;if(!(n instanceof If))throw new Error('CodeGen: "else" without "if"');return this._currNode=n.else=node,this}get _root(){return this._nodes[0]}get _currNode(){const ns=this._nodes;return ns[ns.length-1]}set _currNode(node){const ns=this._nodes;ns[ns.length-1]=node}},exports.not=not;const andCode=mappend(exports.operators.AND);exports.and=function(...args){return args.reduce(andCode)};const orCode=mappend(exports.operators.OR);function mappend(op){return(x,y)=>x===code_1.nil?y:y===code_1.nil?x:code_1._`${par(x)} ${op} ${par(y)}`}function par(x){return x instanceof code_1.Name?x:code_1._`(${x})`}exports.or=function(...args){return args.reduce(orCode)}}(codegen)),codegen}var hasRequiredUtil,util={};function requireUtil(){if(hasRequiredUtil)return util;hasRequiredUtil=1,Object.defineProperty(util,"__esModule",{value:!0}),util.checkStrictMode=util.getErrorPath=util.Type=util.useFunc=util.setEvaluated=util.evaluatedPropsToName=util.mergeEvaluated=util.eachItem=util.unescapeJsonPointer=util.escapeJsonPointer=util.escapeFragment=util.unescapeFragment=util.schemaRefOrVal=util.schemaHasRulesButRef=util.schemaHasRules=util.checkUnknownRules=util.alwaysValidSchema=util.toHash=void 0;const codegen_1=requireCodegen(),code_1=requireCode$1();function checkUnknownRules(it,schema=it.schema){const{opts:opts,self:self}=it;if(!opts.strictSchema)return;if("boolean"==typeof schema)return;const rules=self.RULES.keywords;for(const key in schema)rules[key]||checkStrictMode(it,`unknown keyword: "${key}"`)}function schemaHasRules(schema,rules){if("boolean"==typeof schema)return!schema;for(const key in schema)if(rules[key])return!0;return!1}function escapeJsonPointer(str){return"number"==typeof str?`${str}`:str.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapeJsonPointer(str){return str.replace(/~1/g,"/").replace(/~0/g,"~")}function makeMergeEvaluated({mergeNames:mergeNames,mergeToName:mergeToName,mergeValues:mergeValues,resultToName:resultToName}){return(gen,from,to,toName)=>{const res=void 0===to?from:to instanceof codegen_1.Name?(from instanceof codegen_1.Name?mergeNames(gen,from,to):mergeToName(gen,from,to),to):from instanceof codegen_1.Name?(mergeToName(gen,to,from),from):mergeValues(from,to);return toName!==codegen_1.Name||res instanceof codegen_1.Name?res:resultToName(gen,res)}}function evaluatedPropsToName(gen,ps){if(!0===ps)return gen.var("props",!0);const props=gen.var("props",codegen_1._`{}`);return void 0!==ps&&setEvaluated(gen,props,ps),props}function setEvaluated(gen,props,ps){Object.keys(ps).forEach(p=>gen.assign(codegen_1._`${props}${(0,codegen_1.getProperty)(p)}`,!0))}util.toHash=function(arr){const hash={};for(const item of arr)hash[item]=!0;return hash},util.alwaysValidSchema=function(it,schema){return"boolean"==typeof schema?schema:0===Object.keys(schema).length||(checkUnknownRules(it,schema),!schemaHasRules(schema,it.self.RULES.all))},util.checkUnknownRules=checkUnknownRules,util.schemaHasRules=schemaHasRules,util.schemaHasRulesButRef=function(schema,RULES){if("boolean"==typeof schema)return!schema;for(const key in schema)if("$ref"!==key&&RULES.all[key])return!0;return!1},util.schemaRefOrVal=function({topSchemaRef:topSchemaRef,schemaPath:schemaPath},schema,keyword,$data){if(!$data){if("number"==typeof schema||"boolean"==typeof schema)return schema;if("string"==typeof schema)return codegen_1._`${schema}`}return codegen_1._`${topSchemaRef}${schemaPath}${(0,codegen_1.getProperty)(keyword)}`},util.unescapeFragment=function(str){return unescapeJsonPointer(decodeURIComponent(str))},util.escapeFragment=function(str){return encodeURIComponent(escapeJsonPointer(str))},util.escapeJsonPointer=escapeJsonPointer,util.unescapeJsonPointer=unescapeJsonPointer,util.eachItem=function(xs,f){if(Array.isArray(xs))for(const x of xs)f(x);else f(xs)},util.mergeEvaluated={props:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if(codegen_1._`${to} !== true && ${from} !== undefined`,()=>{gen.if(codegen_1._`${from} === true`,()=>gen.assign(to,!0),()=>gen.assign(to,codegen_1._`${to} || {}`).code(codegen_1._`Object.assign(${to}, ${from})`))}),mergeToName:(gen,from,to)=>gen.if(codegen_1._`${to} !== true`,()=>{!0===from?gen.assign(to,!0):(gen.assign(to,codegen_1._`${to} || {}`),setEvaluated(gen,to,from))}),mergeValues:(from,to)=>!0===from||{...from,...to},resultToName:evaluatedPropsToName}),items:makeMergeEvaluated({mergeNames:(gen,from,to)=>gen.if(codegen_1._`${to} !== true && ${from} !== undefined`,()=>gen.assign(to,codegen_1._`${from} === true ? true : ${to} > ${from} ? ${to} : ${from}`)),mergeToName:(gen,from,to)=>gen.if(codegen_1._`${to} !== true`,()=>gen.assign(to,!0===from||codegen_1._`${to} > ${from} ? ${to} : ${from}`)),mergeValues:(from,to)=>!0===from||Math.max(from,to),resultToName:(gen,items)=>gen.var("items",items)})},util.evaluatedPropsToName=evaluatedPropsToName,util.setEvaluated=setEvaluated;const snippets={};var Type;function checkStrictMode(it,msg,mode=it.opts.strictSchema){if(mode){if(msg=`strict mode: ${msg}`,!0===mode)throw new Error(msg);it.self.logger.warn(msg)}}return util.useFunc=function(gen,f){return gen.scopeValue("func",{ref:f,code:snippets[f.code]||(snippets[f.code]=new code_1._Code(f.code))})},function(Type){Type[Type.Num=0]="Num",Type[Type.Str=1]="Str"}(Type||(util.Type=Type={})),util.getErrorPath=function(dataProp,dataPropType,jsPropertySyntax){if(dataProp instanceof codegen_1.Name){const isNumber=dataPropType===Type.Num;return jsPropertySyntax?isNumber?codegen_1._`"[" + ${dataProp} + "]"`:codegen_1._`"['" + ${dataProp} + "']"`:isNumber?codegen_1._`"/" + ${dataProp}`:codegen_1._`"/" + ${dataProp}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return jsPropertySyntax?(0,codegen_1.getProperty)(dataProp).toString():"/"+escapeJsonPointer(dataProp)},util.checkStrictMode=checkStrictMode,util}var hasRequiredNames,hasRequiredErrors,hasRequiredBoolSchema,names={};function requireNames(){if(hasRequiredNames)return names;hasRequiredNames=1,Object.defineProperty(names,"__esModule",{value:!0});const codegen_1=requireCodegen(),names$1={data:new codegen_1.Name("data"),valCxt:new codegen_1.Name("valCxt"),instancePath:new codegen_1.Name("instancePath"),parentData:new codegen_1.Name("parentData"),parentDataProperty:new codegen_1.Name("parentDataProperty"),rootData:new codegen_1.Name("rootData"),dynamicAnchors:new codegen_1.Name("dynamicAnchors"),vErrors:new codegen_1.Name("vErrors"),errors:new codegen_1.Name("errors"),this:new codegen_1.Name("this"),self:new codegen_1.Name("self"),scope:new codegen_1.Name("scope"),json:new codegen_1.Name("json"),jsonPos:new codegen_1.Name("jsonPos"),jsonLen:new codegen_1.Name("jsonLen"),jsonPart:new codegen_1.Name("jsonPart")};return names.default=names$1,names}function requireErrors(){return hasRequiredErrors||(hasRequiredErrors=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.extendErrors=exports.resetErrorsCount=exports.reportExtraError=exports.reportError=exports.keyword$DataError=exports.keywordError=void 0;const codegen_1=requireCodegen(),util_1=requireUtil(),names_1=requireNames();function addError(gen,errObj){const err=gen.const("err",errObj);gen.if(codegen_1._`${names_1.default.vErrors} === null`,()=>gen.assign(names_1.default.vErrors,codegen_1._`[${err}]`),codegen_1._`${names_1.default.vErrors}.push(${err})`),gen.code(codegen_1._`${names_1.default.errors}++`)}function returnErrors(it,errs){const{gen:gen,validateName:validateName,schemaEnv:schemaEnv}=it;schemaEnv.$async?gen.throw(codegen_1._`new ${it.ValidationError}(${errs})`):(gen.assign(codegen_1._`${validateName}.errors`,errs),gen.return(!1))}exports.keywordError={message:({keyword:keyword})=>codegen_1.str`must pass "${keyword}" keyword validation`},exports.keyword$DataError={message:({keyword:keyword,schemaType:schemaType})=>schemaType?codegen_1.str`"${keyword}" keyword must be ${schemaType} ($data)`:codegen_1.str`"${keyword}" keyword is invalid ($data)`},exports.reportError=function(cxt,error=exports.keywordError,errorPaths,overrideAllErrors){const{it:it}=cxt,{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it,errObj=errorObjectCode(cxt,error,errorPaths);(null!=overrideAllErrors?overrideAllErrors:compositeRule||allErrors)?addError(gen,errObj):returnErrors(it,codegen_1._`[${errObj}]`)},exports.reportExtraError=function(cxt,error=exports.keywordError,errorPaths){const{it:it}=cxt,{gen:gen,compositeRule:compositeRule,allErrors:allErrors}=it;addError(gen,errorObjectCode(cxt,error,errorPaths)),compositeRule||allErrors||returnErrors(it,names_1.default.vErrors)},exports.resetErrorsCount=function(gen,errsCount){gen.assign(names_1.default.errors,errsCount),gen.if(codegen_1._`${names_1.default.vErrors} !== null`,()=>gen.if(errsCount,()=>gen.assign(codegen_1._`${names_1.default.vErrors}.length`,errsCount),()=>gen.assign(names_1.default.vErrors,null)))},exports.extendErrors=function({gen:gen,keyword:keyword,schemaValue:schemaValue,data:data,errsCount:errsCount,it:it}){if(void 0===errsCount)throw new Error("ajv implementation error");const err=gen.name("err");gen.forRange("i",errsCount,names_1.default.errors,i=>{gen.const(err,codegen_1._`${names_1.default.vErrors}[${i}]`),gen.if(codegen_1._`${err}.instancePath === undefined`,()=>gen.assign(codegen_1._`${err}.instancePath`,(0,codegen_1.strConcat)(names_1.default.instancePath,it.errorPath))),gen.assign(codegen_1._`${err}.schemaPath`,codegen_1.str`${it.errSchemaPath}/${keyword}`),it.opts.verbose&&(gen.assign(codegen_1._`${err}.schema`,schemaValue),gen.assign(codegen_1._`${err}.data`,data))})};const E={keyword:new codegen_1.Name("keyword"),schemaPath:new codegen_1.Name("schemaPath"),params:new codegen_1.Name("params"),propertyName:new codegen_1.Name("propertyName"),message:new codegen_1.Name("message"),schema:new codegen_1.Name("schema"),parentSchema:new codegen_1.Name("parentSchema")};function errorObjectCode(cxt,error,errorPaths){const{createErrors:createErrors}=cxt.it;return!1===createErrors?codegen_1._`{}`:function(cxt,error,errorPaths={}){const{gen:gen,it:it}=cxt,keyValues=[errorInstancePath(it,errorPaths),errorSchemaPath(cxt,errorPaths)];return function(cxt,{params:params,message:message},keyValues){const{keyword:keyword,data:data,schemaValue:schemaValue,it:it}=cxt,{opts:opts,propertyName:propertyName,topSchemaRef:topSchemaRef,schemaPath:schemaPath}=it;keyValues.push([E.keyword,keyword],[E.params,"function"==typeof params?params(cxt):params||codegen_1._`{}`]),opts.messages&&keyValues.push([E.message,"function"==typeof message?message(cxt):message]),opts.verbose&&keyValues.push([E.schema,schemaValue],[E.parentSchema,codegen_1._`${topSchemaRef}${schemaPath}`],[names_1.default.data,data]),propertyName&&keyValues.push([E.propertyName,propertyName])}(cxt,error,keyValues),gen.object(...keyValues)}(cxt,error,errorPaths)}function errorInstancePath({errorPath:errorPath},{instancePath:instancePath}){const instPath=instancePath?codegen_1.str`${errorPath}${(0,util_1.getErrorPath)(instancePath,util_1.Type.Str)}`:errorPath;return[names_1.default.instancePath,(0,codegen_1.strConcat)(names_1.default.instancePath,instPath)]}function errorSchemaPath({keyword:keyword,it:{errSchemaPath:errSchemaPath}},{schemaPath:schemaPath,parentSchema:parentSchema}){let schPath=parentSchema?errSchemaPath:codegen_1.str`${errSchemaPath}/${keyword}`;return schemaPath&&(schPath=codegen_1.str`${schPath}${(0,util_1.getErrorPath)(schemaPath,util_1.Type.Str)}`),[E.schemaPath,schPath]}}(errors)),errors}var hasRequiredRules,dataType={},rules={};function requireRules(){if(hasRequiredRules)return rules;hasRequiredRules=1,Object.defineProperty(rules,"__esModule",{value:!0}),rules.getRules=rules.isJSONType=void 0;const jsonTypes=new Set(["string","number","integer","boolean","null","object","array"]);return rules.isJSONType=function(x){return"string"==typeof x&&jsonTypes.has(x)},rules.getRules=function(){const groups={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...groups,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},groups.number,groups.string,groups.array,groups.object],post:{rules:[]},all:{},keywords:{}}},rules}var hasRequiredApplicability,hasRequiredDataType,applicability={};function requireApplicability(){if(hasRequiredApplicability)return applicability;function shouldUseGroup(schema,group){return group.rules.some(rule=>shouldUseRule(schema,rule))}function shouldUseRule(schema,rule){var _a;return void 0!==schema[rule.keyword]||(null===(_a=rule.definition.implements)||void 0===_a?void 0:_a.some(kwd=>void 0!==schema[kwd]))}return hasRequiredApplicability=1,Object.defineProperty(applicability,"__esModule",{value:!0}),applicability.shouldUseRule=applicability.shouldUseGroup=applicability.schemaHasRulesForType=void 0,applicability.schemaHasRulesForType=function({schema:schema,self:self},type){const group=self.RULES.types[type];return group&&!0!==group&&shouldUseGroup(schema,group)},applicability.shouldUseGroup=shouldUseGroup,applicability.shouldUseRule=shouldUseRule,applicability}function requireDataType(){if(hasRequiredDataType)return dataType;hasRequiredDataType=1,Object.defineProperty(dataType,"__esModule",{value:!0}),dataType.reportTypeError=dataType.checkDataTypes=dataType.checkDataType=dataType.coerceAndCheckDataType=dataType.getJSONTypes=dataType.getSchemaTypes=dataType.DataType=void 0;const rules_1=requireRules(),applicability_1=requireApplicability(),errors_1=requireErrors(),codegen_1=requireCodegen(),util_1=requireUtil();var DataType;function getJSONTypes(ts){const types=Array.isArray(ts)?ts:ts?[ts]:[];if(types.every(rules_1.isJSONType))return types;throw new Error("type must be JSONType or JSONType[]: "+types.join(","))}!function(DataType){DataType[DataType.Correct=0]="Correct",DataType[DataType.Wrong=1]="Wrong"}(DataType||(dataType.DataType=DataType={})),dataType.getSchemaTypes=function(schema){const types=getJSONTypes(schema.type);if(types.includes("null")){if(!1===schema.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!types.length&&void 0!==schema.nullable)throw new Error('"nullable" cannot be used without "type"');!0===schema.nullable&&types.push("null")}return types},dataType.getJSONTypes=getJSONTypes,dataType.coerceAndCheckDataType=function(it,types){const{gen:gen,data:data,opts:opts}=it,coerceTo=function(types,coerceTypes){return coerceTypes?types.filter(t=>COERCIBLE.has(t)||"array"===coerceTypes&&"array"===t):[]}(types,opts.coerceTypes),checkTypes=types.length>0&&!(0===coerceTo.length&&1===types.length&&(0,applicability_1.schemaHasRulesForType)(it,types[0]));if(checkTypes){const wrongType=checkDataTypes(types,data,opts.strictNumbers,DataType.Wrong);gen.if(wrongType,()=>{coerceTo.length?function(it,types,coerceTo){const{gen:gen,data:data,opts:opts}=it,dataType=gen.let("dataType",codegen_1._`typeof ${data}`),coerced=gen.let("coerced",codegen_1._`undefined`);"array"===opts.coerceTypes&&gen.if(codegen_1._`${dataType} == 'object' && Array.isArray(${data}) && ${data}.length == 1`,()=>gen.assign(data,codegen_1._`${data}[0]`).assign(dataType,codegen_1._`typeof ${data}`).if(checkDataTypes(types,data,opts.strictNumbers),()=>gen.assign(coerced,data))),gen.if(codegen_1._`${coerced} !== undefined`);for(const t of coerceTo)(COERCIBLE.has(t)||"array"===t&&"array"===opts.coerceTypes)&&coerceSpecificType(t);function coerceSpecificType(t){switch(t){case"string":return void gen.elseIf(codegen_1._`${dataType} == "number" || ${dataType} == "boolean"`).assign(coerced,codegen_1._`"" + ${data}`).elseIf(codegen_1._`${data} === null`).assign(coerced,codegen_1._`""`);case"number":return void gen.elseIf(codegen_1._`${dataType} == "boolean" || ${data} === null
              || (${dataType} == "string" && ${data} && ${data} == +${data})`).assign(coerced,codegen_1._`+${data}`);case"integer":return void gen.elseIf(codegen_1._`${dataType} === "boolean" || ${data} === null
              || (${dataType} === "string" && ${data} && ${data} == +${data} && !(${data} % 1))`).assign(coerced,codegen_1._`+${data}`);case"boolean":return void gen.elseIf(codegen_1._`${data} === "false" || ${data} === 0 || ${data} === null`).assign(coerced,!1).elseIf(codegen_1._`${data} === "true" || ${data} === 1`).assign(coerced,!0);case"null":return gen.elseIf(codegen_1._`${data} === "" || ${data} === 0 || ${data} === false`),void gen.assign(coerced,null);case"array":gen.elseIf(codegen_1._`${dataType} === "string" || ${dataType} === "number"
              || ${dataType} === "boolean" || ${data} === null`).assign(coerced,codegen_1._`[${data}]`)}}gen.else(),reportTypeError(it),gen.endIf(),gen.if(codegen_1._`${coerced} !== undefined`,()=>{gen.assign(data,coerced),function({gen:gen,parentData:parentData,parentDataProperty:parentDataProperty},expr){gen.if(codegen_1._`${parentData} !== undefined`,()=>gen.assign(codegen_1._`${parentData}[${parentDataProperty}]`,expr))}(it,coerced)})}(it,types,coerceTo):reportTypeError(it)})}return checkTypes};const COERCIBLE=new Set(["string","number","integer","boolean","null"]);function checkDataType(dataType,data,strictNums,correct=DataType.Correct){const EQ=correct===DataType.Correct?codegen_1.operators.EQ:codegen_1.operators.NEQ;let cond;switch(dataType){case"null":return codegen_1._`${data} ${EQ} null`;case"array":cond=codegen_1._`Array.isArray(${data})`;break;case"object":cond=codegen_1._`${data} && typeof ${data} == "object" && !Array.isArray(${data})`;break;case"integer":cond=numCond(codegen_1._`!(${data} % 1) && !isNaN(${data})`);break;case"number":cond=numCond();break;default:return codegen_1._`typeof ${data} ${EQ} ${dataType}`}return correct===DataType.Correct?cond:(0,codegen_1.not)(cond);function numCond(_cond=codegen_1.nil){return(0,codegen_1.and)(codegen_1._`typeof ${data} == "number"`,_cond,strictNums?codegen_1._`isFinite(${data})`:codegen_1.nil)}}function checkDataTypes(dataTypes,data,strictNums,correct){if(1===dataTypes.length)return checkDataType(dataTypes[0],data,strictNums,correct);let cond;const types=(0,util_1.toHash)(dataTypes);if(types.array&&types.object){const notObj=codegen_1._`typeof ${data} != "object"`;cond=types.null?notObj:codegen_1._`!${data} || ${notObj}`,delete types.null,delete types.array,delete types.object}else cond=codegen_1.nil;types.number&&delete types.integer;for(const t in types)cond=(0,codegen_1.and)(cond,checkDataType(t,data,strictNums,correct));return cond}dataType.checkDataType=checkDataType,dataType.checkDataTypes=checkDataTypes;const typeError={message:({schema:schema})=>`must be ${schema}`,params:({schema:schema,schemaValue:schemaValue})=>"string"==typeof schema?codegen_1._`{type: ${schema}}`:codegen_1._`{type: ${schemaValue}}`};function reportTypeError(it){const cxt=function(it){const{gen:gen,data:data,schema:schema}=it,schemaCode=(0,util_1.schemaRefOrVal)(it,schema,"type");return{gen:gen,keyword:"type",data:data,schema:schema.type,schemaCode:schemaCode,schemaValue:schemaCode,parentSchema:schema,params:{},it:it}}(it);(0,errors_1.reportError)(cxt,typeError)}return dataType.reportTypeError=reportTypeError,dataType}var hasRequiredDefaults,hasRequiredCode,hasRequiredKeyword,defaults={},keyword={},code={};function requireCode(){if(hasRequiredCode)return code;hasRequiredCode=1,Object.defineProperty(code,"__esModule",{value:!0}),code.validateUnion=code.validateArray=code.usePattern=code.callValidateCode=code.schemaProperties=code.allSchemaProperties=code.noPropertyInData=code.propertyInData=code.isOwnProperty=code.hasPropFunc=code.reportMissingProp=code.checkMissingProp=code.checkReportMissingProp=void 0;const codegen_1=requireCodegen(),util_1=requireUtil(),names_1=requireNames(),util_2=requireUtil();function hasPropFunc(gen){return gen.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:codegen_1._`Object.prototype.hasOwnProperty`})}function isOwnProperty(gen,data,property){return codegen_1._`${hasPropFunc(gen)}.call(${data}, ${property})`}function noPropertyInData(gen,data,property,ownProperties){const cond=codegen_1._`${data}${(0,codegen_1.getProperty)(property)} === undefined`;return ownProperties?(0,codegen_1.or)(cond,(0,codegen_1.not)(isOwnProperty(gen,data,property))):cond}function allSchemaProperties(schemaMap){return schemaMap?Object.keys(schemaMap).filter(p=>"__proto__"!==p):[]}code.checkReportMissingProp=function(cxt,prop){const{gen:gen,data:data,it:it}=cxt;gen.if(noPropertyInData(gen,data,prop,it.opts.ownProperties),()=>{cxt.setParams({missingProperty:codegen_1._`${prop}`},!0),cxt.error()})},code.checkMissingProp=function({gen:gen,data:data,it:{opts:opts}},properties,missing){return(0,codegen_1.or)(...properties.map(prop=>(0,codegen_1.and)(noPropertyInData(gen,data,prop,opts.ownProperties),codegen_1._`${missing} = ${prop}`)))},code.reportMissingProp=function(cxt,missing){cxt.setParams({missingProperty:missing},!0),cxt.error()},code.hasPropFunc=hasPropFunc,code.isOwnProperty=isOwnProperty,code.propertyInData=function(gen,data,property,ownProperties){const cond=codegen_1._`${data}${(0,codegen_1.getProperty)(property)} !== undefined`;return ownProperties?codegen_1._`${cond} && ${isOwnProperty(gen,data,property)}`:cond},code.noPropertyInData=noPropertyInData,code.allSchemaProperties=allSchemaProperties,code.schemaProperties=function(it,schemaMap){return allSchemaProperties(schemaMap).filter(p=>!(0,util_1.alwaysValidSchema)(it,schemaMap[p]))},code.callValidateCode=function({schemaCode:schemaCode,data:data,it:{gen:gen,topSchemaRef:topSchemaRef,schemaPath:schemaPath,errorPath:errorPath},it:it},func,context,passSchema){const dataAndSchema=passSchema?codegen_1._`${schemaCode}, ${data}, ${topSchemaRef}${schemaPath}`:data,valCxt=[[names_1.default.instancePath,(0,codegen_1.strConcat)(names_1.default.instancePath,errorPath)],[names_1.default.parentData,it.parentData],[names_1.default.parentDataProperty,it.parentDataProperty],[names_1.default.rootData,names_1.default.rootData]];it.opts.dynamicRef&&valCxt.push([names_1.default.dynamicAnchors,names_1.default.dynamicAnchors]);const args=codegen_1._`${dataAndSchema}, ${gen.object(...valCxt)}`;return context!==codegen_1.nil?codegen_1._`${func}.call(${context}, ${args})`:codegen_1._`${func}(${args})`};const newRegExp=codegen_1._`new RegExp`;return code.usePattern=function({gen:gen,it:{opts:opts}},pattern){const u=opts.unicodeRegExp?"u":"",{regExp:regExp}=opts.code,rx=regExp(pattern,u);return gen.scopeValue("pattern",{key:rx.toString(),ref:rx,code:codegen_1._`${"new RegExp"===regExp.code?newRegExp:(0,util_2.useFunc)(gen,regExp)}(${pattern}, ${u})`})},code.validateArray=function(cxt){const{gen:gen,data:data,keyword:keyword,it:it}=cxt,valid=gen.name("valid");if(it.allErrors){const validArr=gen.let("valid",!0);return validateItems(()=>gen.assign(validArr,!1)),validArr}return gen.var(valid,!0),validateItems(()=>gen.break()),valid;function validateItems(notValid){const len=gen.const("len",codegen_1._`${data}.length`);gen.forRange("i",0,len,i=>{cxt.subschema({keyword:keyword,dataProp:i,dataPropType:util_1.Type.Num},valid),gen.if((0,codegen_1.not)(valid),notValid)})}},code.validateUnion=function(cxt){const{gen:gen,schema:schema,keyword:keyword,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");if(schema.some(sch=>(0,util_1.alwaysValidSchema)(it,sch))&&!it.opts.unevaluated)return;const valid=gen.let("valid",!1),schValid=gen.name("_valid");gen.block(()=>schema.forEach((_sch,i)=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:i,compositeRule:!0},schValid);gen.assign(valid,codegen_1._`${valid} || ${schValid}`),cxt.mergeValidEvaluated(schCxt,schValid)||gen.if((0,codegen_1.not)(valid))})),cxt.result(valid,()=>cxt.reset(),()=>cxt.error(!0))},code}var hasRequiredSubschema,fastDeepEqual,hasRequiredFastDeepEqual,subschema={},resolve={};function requireFastDeepEqual(){return hasRequiredFastDeepEqual||(hasRequiredFastDeepEqual=1,fastDeepEqual=function equal(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){if(a.constructor!==b.constructor)return!1;var length,i,keys;if(Array.isArray(a)){if((length=a.length)!=b.length)return!1;for(i=length;0!==i--;)if(!equal(a[i],b[i]))return!1;return!0}if(a.constructor===RegExp)return a.source===b.source&&a.flags===b.flags;if(a.valueOf!==Object.prototype.valueOf)return a.valueOf()===b.valueOf();if(a.toString!==Object.prototype.toString)return a.toString()===b.toString();if((length=(keys=Object.keys(a)).length)!==Object.keys(b).length)return!1;for(i=length;0!==i--;)if(!Object.prototype.hasOwnProperty.call(b,keys[i]))return!1;for(i=length;0!==i--;){var key=keys[i];if(!equal(a[key],b[key]))return!1}return!0}return a!=a&&b!=b}),fastDeepEqual}var hasRequiredJsonSchemaTraverse,hasRequiredResolve,hasRequiredValidate,jsonSchemaTraverse={exports:{}};function requireJsonSchemaTraverse(){if(hasRequiredJsonSchemaTraverse)return jsonSchemaTraverse.exports;hasRequiredJsonSchemaTraverse=1;var traverse=jsonSchemaTraverse.exports=function(schema,opts,cb){"function"==typeof opts&&(cb=opts,opts={}),_traverse(opts,"function"==typeof(cb=opts.cb||cb)?cb:cb.pre||function(){},cb.post||function(){},schema,"",schema)};function _traverse(opts,pre,post,schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex){if(schema&&"object"==typeof schema&&!Array.isArray(schema)){for(var key in pre(schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex),schema){var sch=schema[key];if(Array.isArray(sch)){if(key in traverse.arrayKeywords)for(var i=0;i<sch.length;i++)_traverse(opts,pre,post,sch[i],jsonPtr+"/"+key+"/"+i,rootSchema,jsonPtr,key,schema,i)}else if(key in traverse.propsKeywords){if(sch&&"object"==typeof sch)for(var prop in sch)_traverse(opts,pre,post,sch[prop],jsonPtr+"/"+key+"/"+escapeJsonPtr(prop),rootSchema,jsonPtr,key,schema,prop)}else(key in traverse.keywords||opts.allKeys&&!(key in traverse.skipKeywords))&&_traverse(opts,pre,post,sch,jsonPtr+"/"+key,rootSchema,jsonPtr,key,schema)}post(schema,jsonPtr,rootSchema,parentJsonPtr,parentKeyword,parentSchema,keyIndex)}}function escapeJsonPtr(str){return str.replace(/~/g,"~0").replace(/\//g,"~1")}return traverse.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},traverse.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},traverse.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},traverse.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0},jsonSchemaTraverse.exports}function requireResolve(){if(hasRequiredResolve)return resolve;hasRequiredResolve=1,Object.defineProperty(resolve,"__esModule",{value:!0}),resolve.getSchemaRefs=resolve.resolveUrl=resolve.normalizeId=resolve._getFullPath=resolve.getFullPath=resolve.inlineRef=void 0;const util_1=requireUtil(),equal=requireFastDeepEqual(),traverse=requireJsonSchemaTraverse(),SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);resolve.inlineRef=function(schema,limit=!0){return"boolean"==typeof schema||(!0===limit?!hasRef(schema):!!limit&&countKeys(schema)<=limit)};const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(schema){for(const key in schema){if(REF_KEYWORDS.has(key))return!0;const sch=schema[key];if(Array.isArray(sch)&&sch.some(hasRef))return!0;if("object"==typeof sch&&hasRef(sch))return!0}return!1}function countKeys(schema){let count=0;for(const key in schema){if("$ref"===key)return 1/0;if(count++,!SIMPLE_INLINED.has(key)&&("object"==typeof schema[key]&&(0,util_1.eachItem)(schema[key],sch=>count+=countKeys(sch)),count===1/0))return 1/0}return count}function getFullPath(resolver,id="",normalize){!1!==normalize&&(id=normalizeId(id));const p=resolver.parse(id);return _getFullPath(resolver,p)}function _getFullPath(resolver,p){return resolver.serialize(p).split("#")[0]+"#"}resolve.getFullPath=getFullPath,resolve._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(id){return id?id.replace(TRAILING_SLASH_HASH,""):""}resolve.normalizeId=normalizeId,resolve.resolveUrl=function(resolver,baseId,id){return id=normalizeId(id),resolver.resolve(baseId,id)};const ANCHOR=/^[a-z_][-a-z0-9._]*$/i;return resolve.getSchemaRefs=function(schema,baseId){if("boolean"==typeof schema)return{};const{schemaId:schemaId,uriResolver:uriResolver}=this.opts,schId=normalizeId(schema[schemaId]||baseId),baseIds={"":schId},pathPrefix=getFullPath(uriResolver,schId,!1),localRefs={},schemaRefs=new Set;return traverse(schema,{allKeys:!0},(sch,jsonPtr,_,parentJsonPtr)=>{if(void 0===parentJsonPtr)return;const fullPath=pathPrefix+jsonPtr;let innerBaseId=baseIds[parentJsonPtr];function addRef(ref){const _resolve=this.opts.uriResolver.resolve;if(ref=normalizeId(innerBaseId?_resolve(innerBaseId,ref):ref),schemaRefs.has(ref))throw ambiguos(ref);schemaRefs.add(ref);let schOrRef=this.refs[ref];return"string"==typeof schOrRef&&(schOrRef=this.refs[schOrRef]),"object"==typeof schOrRef?checkAmbiguosRef(sch,schOrRef.schema,ref):ref!==normalizeId(fullPath)&&("#"===ref[0]?(checkAmbiguosRef(sch,localRefs[ref],ref),localRefs[ref]=sch):this.refs[ref]=fullPath),ref}function addAnchor(anchor){if("string"==typeof anchor){if(!ANCHOR.test(anchor))throw new Error(`invalid anchor "${anchor}"`);addRef.call(this,`#${anchor}`)}}"string"==typeof sch[schemaId]&&(innerBaseId=addRef.call(this,sch[schemaId])),addAnchor.call(this,sch.$anchor),addAnchor.call(this,sch.$dynamicAnchor),baseIds[jsonPtr]=innerBaseId}),localRefs;function checkAmbiguosRef(sch1,sch2,ref){if(void 0!==sch2&&!equal(sch1,sch2))throw ambiguos(ref)}function ambiguos(ref){return new Error(`reference "${ref}" resolves to more than one schema`)}},resolve}function requireValidate(){if(hasRequiredValidate)return validate;hasRequiredValidate=1,Object.defineProperty(validate,"__esModule",{value:!0}),validate.getData=validate.KeywordCxt=validate.validateFunctionCode=void 0;const boolSchema_1=function(){if(hasRequiredBoolSchema)return boolSchema;hasRequiredBoolSchema=1,Object.defineProperty(boolSchema,"__esModule",{value:!0}),boolSchema.boolOrEmptySchema=boolSchema.topBoolOrEmptySchema=void 0;const errors_1=requireErrors(),codegen_1=requireCodegen(),names_1=requireNames(),boolError={message:"boolean schema is false"};function falseSchemaError(it,overrideAllErrors){const{gen:gen,data:data}=it,cxt={gen:gen,keyword:"false schema",data:data,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:it};(0,errors_1.reportError)(cxt,boolError,void 0,overrideAllErrors)}return boolSchema.topBoolOrEmptySchema=function(it){const{gen:gen,schema:schema,validateName:validateName}=it;!1===schema?falseSchemaError(it,!1):"object"==typeof schema&&!0===schema.$async?gen.return(names_1.default.data):(gen.assign(codegen_1._`${validateName}.errors`,null),gen.return(!0))},boolSchema.boolOrEmptySchema=function(it,valid){const{gen:gen,schema:schema}=it;!1===schema?(gen.var(valid,!1),falseSchemaError(it)):gen.var(valid,!0)},boolSchema}(),dataType_1=requireDataType(),applicability_1=requireApplicability(),dataType_2=requireDataType(),defaults_1=function(){if(hasRequiredDefaults)return defaults;hasRequiredDefaults=1,Object.defineProperty(defaults,"__esModule",{value:!0}),defaults.assignDefaults=void 0;const codegen_1=requireCodegen(),util_1=requireUtil();function assignDefault(it,prop,defaultValue){const{gen:gen,compositeRule:compositeRule,data:data,opts:opts}=it;if(void 0===defaultValue)return;const childData=codegen_1._`${data}${(0,codegen_1.getProperty)(prop)}`;if(compositeRule)return void(0,util_1.checkStrictMode)(it,`default is ignored for: ${childData}`);let condition=codegen_1._`${childData} === undefined`;"empty"===opts.useDefaults&&(condition=codegen_1._`${condition} || ${childData} === null || ${childData} === ""`),gen.if(condition,codegen_1._`${childData} = ${(0,codegen_1.stringify)(defaultValue)}`)}return defaults.assignDefaults=function(it,ty){const{properties:properties,items:items}=it.schema;if("object"===ty&&properties)for(const key in properties)assignDefault(it,key,properties[key].default);else"array"===ty&&Array.isArray(items)&&items.forEach((sch,i)=>assignDefault(it,i,sch.default))},defaults}(),keyword_1=function(){if(hasRequiredKeyword)return keyword;hasRequiredKeyword=1,Object.defineProperty(keyword,"__esModule",{value:!0}),keyword.validateKeywordUsage=keyword.validSchemaType=keyword.funcKeywordCode=keyword.macroKeywordCode=void 0;const codegen_1=requireCodegen(),names_1=requireNames(),code_1=requireCode(),errors_1=requireErrors();function modifyData(cxt){const{gen:gen,data:data,it:it}=cxt;gen.if(it.parentData,()=>gen.assign(data,codegen_1._`${it.parentData}[${it.parentDataProperty}]`))}function useKeyword(gen,keyword,result){if(void 0===result)throw new Error(`keyword "${keyword}" failed to compile`);return gen.scopeValue("keyword","function"==typeof result?{ref:result}:{ref:result,code:(0,codegen_1.stringify)(result)})}return keyword.macroKeywordCode=function(cxt,def){const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,it:it}=cxt,macroSchema=def.macro.call(it.self,schema,parentSchema,it),schemaRef=useKeyword(gen,keyword,macroSchema);!1!==it.opts.validateSchema&&it.self.validateSchema(macroSchema,!0);const valid=gen.name("valid");cxt.subschema({schema:macroSchema,schemaPath:codegen_1.nil,errSchemaPath:`${it.errSchemaPath}/${keyword}`,topSchemaRef:schemaRef,compositeRule:!0},valid),cxt.pass(valid,()=>cxt.error(!0))},keyword.funcKeywordCode=function(cxt,def){var _a;const{gen:gen,keyword:keyword,schema:schema,parentSchema:parentSchema,$data:$data,it:it}=cxt;!function({schemaEnv:schemaEnv},def){if(def.async&&!schemaEnv.$async)throw new Error("async keyword in sync schema")}(it,def);const validate=!$data&&def.compile?def.compile.call(it.self,schema,parentSchema,it):def.validate,validateRef=useKeyword(gen,keyword,validate),valid=gen.let("valid");function assignValid(_await=(def.async?codegen_1._`await `:codegen_1.nil)){const passCxt=it.opts.passContext?names_1.default.this:names_1.default.self,passSchema=!("compile"in def&&!$data||!1===def.schema);gen.assign(valid,codegen_1._`${_await}${(0,code_1.callValidateCode)(cxt,validateRef,passCxt,passSchema)}`,def.modifying)}function reportErrs(errors){var _a;gen.if((0,codegen_1.not)(null!==(_a=def.valid)&&void 0!==_a?_a:valid),errors)}cxt.block$data(valid,function(){if(!1===def.errors)assignValid(),def.modifying&&modifyData(cxt),reportErrs(()=>cxt.error());else{const ruleErrs=def.async?function(){const ruleErrs=gen.let("ruleErrs",null);return gen.try(()=>assignValid(codegen_1._`await `),e=>gen.assign(valid,!1).if(codegen_1._`${e} instanceof ${it.ValidationError}`,()=>gen.assign(ruleErrs,codegen_1._`${e}.errors`),()=>gen.throw(e))),ruleErrs}():function(){const validateErrs=codegen_1._`${validateRef}.errors`;return gen.assign(validateErrs,null),assignValid(codegen_1.nil),validateErrs}();def.modifying&&modifyData(cxt),reportErrs(()=>function(cxt,errs){const{gen:gen}=cxt;gen.if(codegen_1._`Array.isArray(${errs})`,()=>{gen.assign(names_1.default.vErrors,codegen_1._`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`).assign(names_1.default.errors,codegen_1._`${names_1.default.vErrors}.length`),(0,errors_1.extendErrors)(cxt)},()=>cxt.error())}(cxt,ruleErrs))}}),cxt.ok(null!==(_a=def.valid)&&void 0!==_a?_a:valid)},keyword.validSchemaType=function(schema,schemaType,allowUndefined=!1){return!schemaType.length||schemaType.some(st=>"array"===st?Array.isArray(schema):"object"===st?schema&&"object"==typeof schema&&!Array.isArray(schema):typeof schema==st||allowUndefined&&void 0===schema)},keyword.validateKeywordUsage=function({schema:schema,opts:opts,self:self,errSchemaPath:errSchemaPath},def,keyword){if(Array.isArray(def.keyword)?!def.keyword.includes(keyword):def.keyword!==keyword)throw new Error("ajv implementation error");const deps=def.dependencies;if(null==deps?void 0:deps.some(kwd=>!Object.prototype.hasOwnProperty.call(schema,kwd)))throw new Error(`parent schema must have dependencies of ${keyword}: ${deps.join(",")}`);if(def.validateSchema&&!def.validateSchema(schema[keyword])){const msg=`keyword "${keyword}" value is invalid at path "${errSchemaPath}": `+self.errorsText(def.validateSchema.errors);if("log"!==opts.validateSchema)throw new Error(msg);self.logger.error(msg)}},keyword}(),subschema_1=function(){if(hasRequiredSubschema)return subschema;hasRequiredSubschema=1,Object.defineProperty(subschema,"__esModule",{value:!0}),subschema.extendSubschemaMode=subschema.extendSubschemaData=subschema.getSubschema=void 0;const codegen_1=requireCodegen(),util_1=requireUtil();return subschema.getSubschema=function(it,{keyword:keyword,schemaProp:schemaProp,schema:schema,schemaPath:schemaPath,errSchemaPath:errSchemaPath,topSchemaRef:topSchemaRef}){if(void 0!==keyword&&void 0!==schema)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==keyword){const sch=it.schema[keyword];return void 0===schemaProp?{schema:sch,schemaPath:codegen_1._`${it.schemaPath}${(0,codegen_1.getProperty)(keyword)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}`}:{schema:sch[schemaProp],schemaPath:codegen_1._`${it.schemaPath}${(0,codegen_1.getProperty)(keyword)}${(0,codegen_1.getProperty)(schemaProp)}`,errSchemaPath:`${it.errSchemaPath}/${keyword}/${(0,util_1.escapeFragment)(schemaProp)}`}}if(void 0!==schema){if(void 0===schemaPath||void 0===errSchemaPath||void 0===topSchemaRef)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:schema,schemaPath:schemaPath,topSchemaRef:topSchemaRef,errSchemaPath:errSchemaPath}}throw new Error('either "keyword" or "schema" must be passed')},subschema.extendSubschemaData=function(subschema,it,{dataProp:dataProp,dataPropType:dpType,data:data,dataTypes:dataTypes,propertyName:propertyName}){if(void 0!==data&&void 0!==dataProp)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:gen}=it;if(void 0!==dataProp){const{errorPath:errorPath,dataPathArr:dataPathArr,opts:opts}=it;dataContextProps(gen.let("data",codegen_1._`${it.data}${(0,codegen_1.getProperty)(dataProp)}`,!0)),subschema.errorPath=codegen_1.str`${errorPath}${(0,util_1.getErrorPath)(dataProp,dpType,opts.jsPropertySyntax)}`,subschema.parentDataProperty=codegen_1._`${dataProp}`,subschema.dataPathArr=[...dataPathArr,subschema.parentDataProperty]}function dataContextProps(_nextData){subschema.data=_nextData,subschema.dataLevel=it.dataLevel+1,subschema.dataTypes=[],it.definedProperties=new Set,subschema.parentData=it.data,subschema.dataNames=[...it.dataNames,_nextData]}void 0!==data&&(dataContextProps(data instanceof codegen_1.Name?data:gen.let("data",data,!0)),void 0!==propertyName&&(subschema.propertyName=propertyName)),dataTypes&&(subschema.dataTypes=dataTypes)},subschema.extendSubschemaMode=function(subschema,{jtdDiscriminator:jtdDiscriminator,jtdMetadata:jtdMetadata,compositeRule:compositeRule,createErrors:createErrors,allErrors:allErrors}){void 0!==compositeRule&&(subschema.compositeRule=compositeRule),void 0!==createErrors&&(subschema.createErrors=createErrors),void 0!==allErrors&&(subschema.allErrors=allErrors),subschema.jtdDiscriminator=jtdDiscriminator,subschema.jtdMetadata=jtdMetadata},subschema}(),codegen_1=requireCodegen(),names_1=requireNames(),resolve_1=requireResolve(),util_1=requireUtil(),errors_1=requireErrors();function validateFunction({gen:gen,validateName:validateName,schema:schema,schemaEnv:schemaEnv,opts:opts},body){opts.code.es5?gen.func(validateName,codegen_1._`${names_1.default.data}, ${names_1.default.valCxt}`,schemaEnv.$async,()=>{gen.code(codegen_1._`"use strict"; ${funcSourceUrl(schema,opts)}`),function(gen,opts){gen.if(names_1.default.valCxt,()=>{gen.var(names_1.default.instancePath,codegen_1._`${names_1.default.valCxt}.${names_1.default.instancePath}`),gen.var(names_1.default.parentData,codegen_1._`${names_1.default.valCxt}.${names_1.default.parentData}`),gen.var(names_1.default.parentDataProperty,codegen_1._`${names_1.default.valCxt}.${names_1.default.parentDataProperty}`),gen.var(names_1.default.rootData,codegen_1._`${names_1.default.valCxt}.${names_1.default.rootData}`),opts.dynamicRef&&gen.var(names_1.default.dynamicAnchors,codegen_1._`${names_1.default.valCxt}.${names_1.default.dynamicAnchors}`)},()=>{gen.var(names_1.default.instancePath,codegen_1._`""`),gen.var(names_1.default.parentData,codegen_1._`undefined`),gen.var(names_1.default.parentDataProperty,codegen_1._`undefined`),gen.var(names_1.default.rootData,names_1.default.data),opts.dynamicRef&&gen.var(names_1.default.dynamicAnchors,codegen_1._`{}`)})}(gen,opts),gen.code(body)}):gen.func(validateName,codegen_1._`${names_1.default.data}, ${function(opts){return codegen_1._`{${names_1.default.instancePath}="", ${names_1.default.parentData}, ${names_1.default.parentDataProperty}, ${names_1.default.rootData}=${names_1.default.data}${opts.dynamicRef?codegen_1._`, ${names_1.default.dynamicAnchors}={}`:codegen_1.nil}}={}`}(opts)}`,schemaEnv.$async,()=>gen.code(funcSourceUrl(schema,opts)).code(body))}function funcSourceUrl(schema,opts){const schId="object"==typeof schema&&schema[opts.schemaId];return schId&&(opts.code.source||opts.code.process)?codegen_1._`/*# sourceURL=${schId} */`:codegen_1.nil}function schemaCxtHasRules({schema:schema,self:self}){if("boolean"==typeof schema)return!schema;for(const key in schema)if(self.RULES.all[key])return!0;return!1}function isSchemaObj(it){return"boolean"!=typeof it.schema}function checkKeywords(it){(0,util_1.checkUnknownRules)(it),function(it){const{schema:schema,errSchemaPath:errSchemaPath,opts:opts,self:self}=it;schema.$ref&&opts.ignoreKeywordsWithRef&&(0,util_1.schemaHasRulesButRef)(schema,self.RULES)&&self.logger.warn(`$ref: keywords ignored in schema at path "${errSchemaPath}"`)}(it)}function typeAndKeywords(it,errsCount){if(it.opts.jtd)return schemaKeywords(it,[],!1,errsCount);const types=(0,dataType_1.getSchemaTypes)(it.schema);schemaKeywords(it,types,!(0,dataType_1.coerceAndCheckDataType)(it,types),errsCount)}function commentKeyword({gen:gen,schemaEnv:schemaEnv,schema:schema,errSchemaPath:errSchemaPath,opts:opts}){const msg=schema.$comment;if(!0===opts.$comment)gen.code(codegen_1._`${names_1.default.self}.logger.log(${msg})`);else if("function"==typeof opts.$comment){const schemaPath=codegen_1.str`${errSchemaPath}/$comment`,rootName=gen.scopeValue("root",{ref:schemaEnv.root});gen.code(codegen_1._`${names_1.default.self}.opts.$comment(${msg}, ${schemaPath}, ${rootName}.schema)`)}}function schemaKeywords(it,types,typeErrors,errsCount){const{gen:gen,schema:schema,data:data,allErrors:allErrors,opts:opts,self:self}=it,{RULES:RULES}=self;function groupKeywords(group){(0,applicability_1.shouldUseGroup)(schema,group)&&(group.type?(gen.if((0,dataType_2.checkDataType)(group.type,data,opts.strictNumbers)),iterateKeywords(it,group),1===types.length&&types[0]===group.type&&typeErrors&&(gen.else(),(0,dataType_2.reportTypeError)(it)),gen.endIf()):iterateKeywords(it,group),allErrors||gen.if(codegen_1._`${names_1.default.errors} === ${errsCount||0}`))}!schema.$ref||!opts.ignoreKeywordsWithRef&&(0,util_1.schemaHasRulesButRef)(schema,RULES)?(opts.jtd||function(it,types){!it.schemaEnv.meta&&it.opts.strictTypes&&(function(it,types){types.length&&(it.dataTypes.length?(types.forEach(t=>{includesType(it.dataTypes,t)||strictTypesError(it,`type "${t}" not allowed by context "${it.dataTypes.join(",")}"`)}),function(it,withTypes){const ts=[];for(const t of it.dataTypes)includesType(withTypes,t)?ts.push(t):withTypes.includes("integer")&&"number"===t&&ts.push("integer");it.dataTypes=ts}(it,types)):it.dataTypes=types)}(it,types),it.opts.allowUnionTypes||function(it,ts){ts.length>1&&(2!==ts.length||!ts.includes("null"))&&strictTypesError(it,"use allowUnionTypes to allow union type keyword")}(it,types),function(it,ts){const rules=it.self.RULES.all;for(const keyword in rules){const rule=rules[keyword];if("object"==typeof rule&&(0,applicability_1.shouldUseRule)(it.schema,rule)){const{type:type}=rule.definition;type.length&&!type.some(t=>{return kwdT=t,(schTs=ts).includes(kwdT)||"number"===kwdT&&schTs.includes("integer");var schTs,kwdT})&&strictTypesError(it,`missing type "${type.join(",")}" for keyword "${keyword}"`)}}}(it,it.dataTypes))}(it,types),gen.block(()=>{for(const group of RULES.rules)groupKeywords(group);groupKeywords(RULES.post)})):gen.block(()=>keywordCode(it,"$ref",RULES.all.$ref.definition))}function iterateKeywords(it,group){const{gen:gen,schema:schema,opts:{useDefaults:useDefaults}}=it;useDefaults&&(0,defaults_1.assignDefaults)(it,group.type),gen.block(()=>{for(const rule of group.rules)(0,applicability_1.shouldUseRule)(schema,rule)&&keywordCode(it,rule.keyword,rule.definition,group.type)})}function includesType(ts,t){return ts.includes(t)||"integer"===t&&ts.includes("number")}function strictTypesError(it,msg){msg+=` at "${it.schemaEnv.baseId+it.errSchemaPath}" (strictTypes)`,(0,util_1.checkStrictMode)(it,msg,it.opts.strictTypes)}validate.validateFunctionCode=function(it){isSchemaObj(it)&&(checkKeywords(it),schemaCxtHasRules(it))?function(it){const{schema:schema,opts:opts,gen:gen}=it;validateFunction(it,()=>{opts.$comment&&schema.$comment&&commentKeyword(it),function(it){const{schema:schema,opts:opts}=it;void 0!==schema.default&&opts.useDefaults&&opts.strictSchema&&(0,util_1.checkStrictMode)(it,"default is ignored in the schema root")}(it),gen.let(names_1.default.vErrors,null),gen.let(names_1.default.errors,0),opts.unevaluated&&function(it){const{gen:gen,validateName:validateName}=it;it.evaluated=gen.const("evaluated",codegen_1._`${validateName}.evaluated`),gen.if(codegen_1._`${it.evaluated}.dynamicProps`,()=>gen.assign(codegen_1._`${it.evaluated}.props`,codegen_1._`undefined`)),gen.if(codegen_1._`${it.evaluated}.dynamicItems`,()=>gen.assign(codegen_1._`${it.evaluated}.items`,codegen_1._`undefined`))}(it),typeAndKeywords(it),function(it){const{gen:gen,schemaEnv:schemaEnv,validateName:validateName,ValidationError:ValidationError,opts:opts}=it;schemaEnv.$async?gen.if(codegen_1._`${names_1.default.errors} === 0`,()=>gen.return(names_1.default.data),()=>gen.throw(codegen_1._`new ${ValidationError}(${names_1.default.vErrors})`)):(gen.assign(codegen_1._`${validateName}.errors`,names_1.default.vErrors),opts.unevaluated&&function({gen:gen,evaluated:evaluated,props:props,items:items}){props instanceof codegen_1.Name&&gen.assign(codegen_1._`${evaluated}.props`,props),items instanceof codegen_1.Name&&gen.assign(codegen_1._`${evaluated}.items`,items)}(it),gen.return(codegen_1._`${names_1.default.errors} === 0`))}(it)})}(it):validateFunction(it,()=>(0,boolSchema_1.topBoolOrEmptySchema)(it))};class KeywordCxt{constructor(it,def,keyword){if((0,keyword_1.validateKeywordUsage)(it,def,keyword),this.gen=it.gen,this.allErrors=it.allErrors,this.keyword=keyword,this.data=it.data,this.schema=it.schema[keyword],this.$data=def.$data&&it.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,util_1.schemaRefOrVal)(it,this.schema,keyword,this.$data),this.schemaType=def.schemaType,this.parentSchema=it.schema,this.params={},this.it=it,this.def=def,this.$data)this.schemaCode=it.gen.const("vSchema",getData(this.$data,it));else if(this.schemaCode=this.schemaValue,!(0,keyword_1.validSchemaType)(this.schema,def.schemaType,def.allowUndefined))throw new Error(`${keyword} value must be ${JSON.stringify(def.schemaType)}`);("code"in def?def.trackErrors:!1!==def.errors)&&(this.errsCount=it.gen.const("_errs",names_1.default.errors))}result(condition,successAction,failAction){this.failResult((0,codegen_1.not)(condition),successAction,failAction)}failResult(condition,successAction,failAction){this.gen.if(condition),failAction?failAction():this.error(),successAction?(this.gen.else(),successAction(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(condition,failAction){this.failResult((0,codegen_1.not)(condition),void 0,failAction)}fail(condition){if(void 0===condition)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(condition),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(condition){if(!this.$data)return this.fail(condition);const{schemaCode:schemaCode}=this;this.fail(codegen_1._`${schemaCode} !== undefined && (${(0,codegen_1.or)(this.invalid$data(),condition)})`)}error(append,errorParams,errorPaths){if(errorParams)return this.setParams(errorParams),this._error(append,errorPaths),void this.setParams({});this._error(append,errorPaths)}_error(append,errorPaths){(append?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error,errorPaths)}$dataError(){(0,errors_1.reportError)(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,errors_1.resetErrorsCount)(this.gen,this.errsCount)}ok(cond){this.allErrors||this.gen.if(cond)}setParams(obj,assign){assign?Object.assign(this.params,obj):this.params=obj}block$data(valid,codeBlock,$dataValid=codegen_1.nil){this.gen.block(()=>{this.check$data(valid,$dataValid),codeBlock()})}check$data(valid=codegen_1.nil,$dataValid=codegen_1.nil){if(!this.$data)return;const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def}=this;gen.if((0,codegen_1.or)(codegen_1._`${schemaCode} === undefined`,$dataValid)),valid!==codegen_1.nil&&gen.assign(valid,!0),(schemaType.length||def.validateSchema)&&(gen.elseIf(this.invalid$data()),this.$dataError(),valid!==codegen_1.nil&&gen.assign(valid,!1)),gen.else()}invalid$data(){const{gen:gen,schemaCode:schemaCode,schemaType:schemaType,def:def,it:it}=this;return(0,codegen_1.or)(function(){if(schemaType.length){if(!(schemaCode instanceof codegen_1.Name))throw new Error("ajv implementation error");const st=Array.isArray(schemaType)?schemaType:[schemaType];return codegen_1._`${(0,dataType_2.checkDataTypes)(st,schemaCode,it.opts.strictNumbers,dataType_2.DataType.Wrong)}`}return codegen_1.nil}(),function(){if(def.validateSchema){const validateSchemaRef=gen.scopeValue("validate$data",{ref:def.validateSchema});return codegen_1._`!${validateSchemaRef}(${schemaCode})`}return codegen_1.nil}())}subschema(appl,valid){const subschema=(0,subschema_1.getSubschema)(this.it,appl);(0,subschema_1.extendSubschemaData)(subschema,this.it,appl),(0,subschema_1.extendSubschemaMode)(subschema,appl);const nextContext={...this.it,...subschema,items:void 0,props:void 0};return function(it,valid){isSchemaObj(it)&&(checkKeywords(it),schemaCxtHasRules(it))?function(it,valid){const{schema:schema,gen:gen,opts:opts}=it;opts.$comment&&schema.$comment&&commentKeyword(it),function(it){const schId=it.schema[it.opts.schemaId];schId&&(it.baseId=(0,resolve_1.resolveUrl)(it.opts.uriResolver,it.baseId,schId))}(it),function(it){if(it.schema.$async&&!it.schemaEnv.$async)throw new Error("async schema in sync schema")}(it);const errsCount=gen.const("_errs",names_1.default.errors);typeAndKeywords(it,errsCount),gen.var(valid,codegen_1._`${errsCount} === ${names_1.default.errors}`)}(it,valid):(0,boolSchema_1.boolOrEmptySchema)(it,valid)}(nextContext,valid),nextContext}mergeEvaluated(schemaCxt,toName){const{it:it,gen:gen}=this;it.opts.unevaluated&&(!0!==it.props&&void 0!==schemaCxt.props&&(it.props=util_1.mergeEvaluated.props(gen,schemaCxt.props,it.props,toName)),!0!==it.items&&void 0!==schemaCxt.items&&(it.items=util_1.mergeEvaluated.items(gen,schemaCxt.items,it.items,toName)))}mergeValidEvaluated(schemaCxt,valid){const{it:it,gen:gen}=this;if(it.opts.unevaluated&&(!0!==it.props||!0!==it.items))return gen.if(valid,()=>this.mergeEvaluated(schemaCxt,codegen_1.Name)),!0}}function keywordCode(it,keyword,def,ruleType){const cxt=new KeywordCxt(it,def,keyword);"code"in def?def.code(cxt,ruleType):cxt.$data&&def.validate?(0,keyword_1.funcKeywordCode)(cxt,def):"macro"in def?(0,keyword_1.macroKeywordCode)(cxt,def):(def.compile||def.validate)&&(0,keyword_1.funcKeywordCode)(cxt,def)}validate.KeywordCxt=KeywordCxt;const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/,RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData($data,{dataLevel:dataLevel,dataNames:dataNames,dataPathArr:dataPathArr}){let jsonPointer,data;if(""===$data)return names_1.default.rootData;if("/"===$data[0]){if(!JSON_POINTER.test($data))throw new Error(`Invalid JSON-pointer: ${$data}`);jsonPointer=$data,data=names_1.default.rootData}else{const matches=RELATIVE_JSON_POINTER.exec($data);if(!matches)throw new Error(`Invalid JSON-pointer: ${$data}`);const up=+matches[1];if(jsonPointer=matches[2],"#"===jsonPointer){if(up>=dataLevel)throw new Error(errorMsg("property/index",up));return dataPathArr[dataLevel-up]}if(up>dataLevel)throw new Error(errorMsg("data",up));if(data=dataNames[dataLevel-up],!jsonPointer)return data}let expr=data;const segments=jsonPointer.split("/");for(const segment of segments)segment&&(data=codegen_1._`${data}${(0,codegen_1.getProperty)((0,util_1.unescapeJsonPointer)(segment))}`,expr=codegen_1._`${expr} && ${data}`);return expr;function errorMsg(pointerType,up){return`Cannot access ${pointerType} ${up} levels up, current level is ${dataLevel}`}}return validate.getData=getData,validate}var hasRequiredValidation_error,validation_error={};function requireValidation_error(){if(hasRequiredValidation_error)return validation_error;hasRequiredValidation_error=1,Object.defineProperty(validation_error,"__esModule",{value:!0});class ValidationError extends Error{constructor(errors){super("validation failed"),this.errors=errors,this.ajv=this.validation=!0}}return validation_error.default=ValidationError,validation_error}var hasRequiredRef_error,ref_error={};function requireRef_error(){if(hasRequiredRef_error)return ref_error;hasRequiredRef_error=1,Object.defineProperty(ref_error,"__esModule",{value:!0});const resolve_1=requireResolve();class MissingRefError extends Error{constructor(resolver,baseId,ref,msg){super(msg||`can't resolve reference ${ref} from id ${baseId}`),this.missingRef=(0,resolve_1.resolveUrl)(resolver,baseId,ref),this.missingSchema=(0,resolve_1.normalizeId)((0,resolve_1.getFullPath)(resolver,this.missingRef))}}return ref_error.default=MissingRefError,ref_error}var hasRequiredCompile,compile={};function requireCompile(){if(hasRequiredCompile)return compile;hasRequiredCompile=1,Object.defineProperty(compile,"__esModule",{value:!0}),compile.resolveSchema=compile.getCompilingSchema=compile.resolveRef=compile.compileSchema=compile.SchemaEnv=void 0;const codegen_1=requireCodegen(),validation_error_1=requireValidation_error(),names_1=requireNames(),resolve_1=requireResolve(),util_1=requireUtil(),validate_1=requireValidate();class SchemaEnv{constructor(env){var _a;let schema;this.refs={},this.dynamicAnchors={},"object"==typeof env.schema&&(schema=env.schema),this.schema=env.schema,this.schemaId=env.schemaId,this.root=env.root||this,this.baseId=null!==(_a=env.baseId)&&void 0!==_a?_a:(0,resolve_1.normalizeId)(null==schema?void 0:schema[env.schemaId||"$id"]),this.schemaPath=env.schemaPath,this.localRefs=env.localRefs,this.meta=env.meta,this.$async=null==schema?void 0:schema.$async,this.refs={}}}function compileSchema(sch){const _sch=getCompilingSchema.call(this,sch);if(_sch)return _sch;const rootId=(0,resolve_1.getFullPath)(this.opts.uriResolver,sch.root.baseId),{es5:es5,lines:lines}=this.opts.code,{ownProperties:ownProperties}=this.opts,gen=new codegen_1.CodeGen(this.scope,{es5:es5,lines:lines,ownProperties:ownProperties});let _ValidationError;sch.$async&&(_ValidationError=gen.scopeValue("Error",{ref:validation_error_1.default,code:codegen_1._`require("ajv/dist/runtime/validation_error").default`}));const validateName=gen.scopeName("validate");sch.validateName=validateName;const schemaCxt={gen:gen,allErrors:this.opts.allErrors,data:names_1.default.data,parentData:names_1.default.parentData,parentDataProperty:names_1.default.parentDataProperty,dataNames:[names_1.default.data],dataPathArr:[codegen_1.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:gen.scopeValue("schema",!0===this.opts.code.source?{ref:sch.schema,code:(0,codegen_1.stringify)(sch.schema)}:{ref:sch.schema}),validateName:validateName,ValidationError:_ValidationError,schema:sch.schema,schemaEnv:sch,rootId:rootId,baseId:sch.baseId||rootId,schemaPath:codegen_1.nil,errSchemaPath:sch.schemaPath||(this.opts.jtd?"":"#"),errorPath:codegen_1._`""`,opts:this.opts,self:this};let sourceCode;try{this._compilations.add(sch),(0,validate_1.validateFunctionCode)(schemaCxt),gen.optimize(this.opts.code.optimize);const validateCode=gen.toString();sourceCode=`${gen.scopeRefs(names_1.default.scope)}return ${validateCode}`,this.opts.code.process&&(sourceCode=this.opts.code.process(sourceCode,sch));const validate=new Function(`${names_1.default.self}`,`${names_1.default.scope}`,sourceCode)(this,this.scope.get());if(this.scope.value(validateName,{ref:validate}),validate.errors=null,validate.schema=sch.schema,validate.schemaEnv=sch,sch.$async&&(validate.$async=!0),!0===this.opts.code.source&&(validate.source={validateName:validateName,validateCode:validateCode,scopeValues:gen._values}),this.opts.unevaluated){const{props:props,items:items}=schemaCxt;validate.evaluated={props:props instanceof codegen_1.Name?void 0:props,items:items instanceof codegen_1.Name?void 0:items,dynamicProps:props instanceof codegen_1.Name,dynamicItems:items instanceof codegen_1.Name},validate.source&&(validate.source.evaluated=(0,codegen_1.stringify)(validate.evaluated))}return sch.validate=validate,sch}catch(e){throw delete sch.validate,delete sch.validateName,sourceCode&&this.logger.error("Error compiling schema, function code:",sourceCode),e}finally{this._compilations.delete(sch)}}function inlineOrCompile(sch){return(0,resolve_1.inlineRef)(sch.schema,this.opts.inlineRefs)?sch.schema:sch.validate?sch:compileSchema.call(this,sch)}function getCompilingSchema(schEnv){for(const sch of this._compilations)if(sameSchemaEnv(sch,schEnv))return sch}function sameSchemaEnv(s1,s2){return s1.schema===s2.schema&&s1.root===s2.root&&s1.baseId===s2.baseId}function resolve(root,ref){let sch;for(;"string"==typeof(sch=this.refs[ref]);)ref=sch;return sch||this.schemas[ref]||resolveSchema.call(this,root,ref)}function resolveSchema(root,ref){const p=this.opts.uriResolver.parse(ref),refPath=(0,resolve_1._getFullPath)(this.opts.uriResolver,p);let baseId=(0,resolve_1.getFullPath)(this.opts.uriResolver,root.baseId,void 0);if(Object.keys(root.schema).length>0&&refPath===baseId)return getJsonPointer.call(this,p,root);const id=(0,resolve_1.normalizeId)(refPath),schOrRef=this.refs[id]||this.schemas[id];if("string"==typeof schOrRef){const sch=resolveSchema.call(this,root,schOrRef);if("object"!=typeof(null==sch?void 0:sch.schema))return;return getJsonPointer.call(this,p,sch)}if("object"==typeof(null==schOrRef?void 0:schOrRef.schema)){if(schOrRef.validate||compileSchema.call(this,schOrRef),id===(0,resolve_1.normalizeId)(ref)){const{schema:schema}=schOrRef,{schemaId:schemaId}=this.opts,schId=schema[schemaId];return schId&&(baseId=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schId)),new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId})}return getJsonPointer.call(this,p,schOrRef)}}compile.SchemaEnv=SchemaEnv,compile.compileSchema=compileSchema,compile.resolveRef=function(root,baseId,ref){var _a;ref=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,ref);const schOrFunc=root.refs[ref];if(schOrFunc)return schOrFunc;let _sch=resolve.call(this,root,ref);if(void 0===_sch){const schema=null===(_a=root.localRefs)||void 0===_a?void 0:_a[ref],{schemaId:schemaId}=this.opts;schema&&(_sch=new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId}))}return void 0!==_sch?root.refs[ref]=inlineOrCompile.call(this,_sch):void 0},compile.getCompilingSchema=getCompilingSchema,compile.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(parsedRef,{baseId:baseId,schema:schema,root:root}){var _a;if("/"!==(null===(_a=parsedRef.fragment)||void 0===_a?void 0:_a[0]))return;for(const part of parsedRef.fragment.slice(1).split("/")){if("boolean"==typeof schema)return;const partSchema=schema[(0,util_1.unescapeFragment)(part)];if(void 0===partSchema)return;const schId="object"==typeof(schema=partSchema)&&schema[this.opts.schemaId];!PREVENT_SCOPE_CHANGE.has(part)&&schId&&(baseId=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schId))}let env;if("boolean"!=typeof schema&&schema.$ref&&!(0,util_1.schemaHasRulesButRef)(schema,this.RULES)){const $ref=(0,resolve_1.resolveUrl)(this.opts.uriResolver,baseId,schema.$ref);env=resolveSchema.call(this,root,$ref)}const{schemaId:schemaId}=this.opts;return env=env||new SchemaEnv({schema:schema,schemaId:schemaId,root:root,baseId:baseId}),env.schema!==env.root.schema?env:void 0}return compile}var scopedChars,hasRequiredScopedChars,utils,hasRequiredUtils,schemes,hasRequiredSchemes,hasRequiredFastUri,hasRequiredUri,hasRequiredCore$1,require$$9={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1},uri={},fastUri={exports:{}};function requireFastUri(){if(hasRequiredFastUri)return fastUri.exports;hasRequiredFastUri=1;const{normalizeIPv6:normalizeIPv6,normalizeIPv4:normalizeIPv4,removeDotSegments:removeDotSegments,recomposeAuthority:recomposeAuthority,normalizeComponentEncoding:normalizeComponentEncoding}=function(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;const{HEX:HEX}=hasRequiredScopedChars?scopedChars:(hasRequiredScopedChars=1,scopedChars={HEX:{0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15}}),IPV4_REG=/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u;function normalizeIPv4(host){if(findToken(host,".")<3)return{host:host,isIPV4:!1};const matches=host.match(IPV4_REG)||[],[address]=matches;return address?{host:stripLeadingZeros(address,"."),isIPV4:!0}:{host:host,isIPV4:!1}}function stringArrayToHexStripped(input,keepZero=!1){let acc="",strip=!0;for(const c of input){if(void 0===HEX[c])return;"0"!==c&&!0===strip&&(strip=!1),strip||(acc+=c)}return keepZero&&0===acc.length&&(acc="0"),acc}function normalizeIPv6(host){if(findToken(host,":")<2)return{host:host,isIPV6:!1};const ipv6=function(input){let tokenCount=0;const output={error:!1,address:"",zone:""},address=[],buffer=[];let isZone=!1,endipv6Encountered=!1,endIpv6=!1;function consume(){if(buffer.length){if(!1===isZone){const hex=stringArrayToHexStripped(buffer);if(void 0===hex)return output.error=!0,!1;address.push(hex)}buffer.length=0}return!0}for(let i=0;i<input.length;i++){const cursor=input[i];if("["!==cursor&&"]"!==cursor)if(":"!==cursor)if("%"===cursor){if(!consume())break;isZone=!0}else buffer.push(cursor);else{if(!0===endipv6Encountered&&(endIpv6=!0),!consume())break;if(tokenCount++,address.push(":"),tokenCount>7){output.error=!0;break}i-1>=0&&":"===input[i-1]&&(endipv6Encountered=!0)}}return buffer.length&&(isZone?output.zone=buffer.join(""):endIpv6?address.push(buffer.join("")):address.push(stringArrayToHexStripped(buffer))),output.address=address.join(""),output}(host);if(ipv6.error)return{host:host,isIPV6:!1};{let newHost=ipv6.address,escapedHost=ipv6.address;return ipv6.zone&&(newHost+="%"+ipv6.zone,escapedHost+="%25"+ipv6.zone),{host:newHost,escapedHost:escapedHost,isIPV6:!0}}}function stripLeadingZeros(str,token){let out="",skip=!0;const l=str.length;for(let i=0;i<l;i++){const c=str[i];"0"===c&&skip?(i+1<=l&&str[i+1]===token||i+1===l)&&(out+=c,skip=!1):(skip=c===token,out+=c)}return out}function findToken(str,token){let ind=0;for(let i=0;i<str.length;i++)str[i]===token&&ind++;return ind}const RDS1=/^\.\.?\//u,RDS2=/^\/\.(?:\/|$)/u,RDS3=/^\/\.\.(?:\/|$)/u,RDS5=/^\/?(?:.|\n)*?(?=\/|$)/u;return utils={recomposeAuthority:function(components){const uriTokens=[];if(void 0!==components.userinfo&&(uriTokens.push(components.userinfo),uriTokens.push("@")),void 0!==components.host){let host=unescape(components.host);const ipV4res=normalizeIPv4(host);if(ipV4res.isIPV4)host=ipV4res.host;else{const ipV6res=normalizeIPv6(ipV4res.host);host=!0===ipV6res.isIPV6?`[${ipV6res.escapedHost}]`:components.host}uriTokens.push(host)}return"number"!=typeof components.port&&"string"!=typeof components.port||(uriTokens.push(":"),uriTokens.push(String(components.port))),uriTokens.length?uriTokens.join(""):void 0},normalizeComponentEncoding:function(components,esc){const func=!0!==esc?escape:unescape;return void 0!==components.scheme&&(components.scheme=func(components.scheme)),void 0!==components.userinfo&&(components.userinfo=func(components.userinfo)),void 0!==components.host&&(components.host=func(components.host)),void 0!==components.path&&(components.path=func(components.path)),void 0!==components.query&&(components.query=func(components.query)),void 0!==components.fragment&&(components.fragment=func(components.fragment)),components},removeDotSegments:function(input){const output=[];for(;input.length;)if(input.match(RDS1))input=input.replace(RDS1,"");else if(input.match(RDS2))input=input.replace(RDS2,"/");else if(input.match(RDS3))input=input.replace(RDS3,"/"),output.pop();else if("."===input||".."===input)input="";else{const im=input.match(RDS5);if(!im)throw new Error("Unexpected dot segment condition");{const s=im[0];input=input.slice(s.length),output.push(s)}}return output.join("")},normalizeIPv4:normalizeIPv4,normalizeIPv6:normalizeIPv6,stringArrayToHexStripped:stringArrayToHexStripped}}(),SCHEMES=function(){if(hasRequiredSchemes)return schemes;hasRequiredSchemes=1;const UUID_REG=/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu,URN_REG=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function isSecure(wsComponents){return"boolean"==typeof wsComponents.secure?wsComponents.secure:"wss"===String(wsComponents.scheme).toLowerCase()}function httpParse(components){return components.host||(components.error=components.error||"HTTP URIs must have a host."),components}function httpSerialize(components){const secure="https"===String(components.scheme).toLowerCase();return components.port!==(secure?443:80)&&""!==components.port||(components.port=void 0),components.path||(components.path="/"),components}const http={scheme:"http",domainHost:!0,parse:httpParse,serialize:httpSerialize},ws={scheme:"ws",domainHost:!0,parse:function(wsComponents){return wsComponents.secure=isSecure(wsComponents),wsComponents.resourceName=(wsComponents.path||"/")+(wsComponents.query?"?"+wsComponents.query:""),wsComponents.path=void 0,wsComponents.query=void 0,wsComponents},serialize:function(wsComponents){if(wsComponents.port!==(isSecure(wsComponents)?443:80)&&""!==wsComponents.port||(wsComponents.port=void 0),"boolean"==typeof wsComponents.secure&&(wsComponents.scheme=wsComponents.secure?"wss":"ws",wsComponents.secure=void 0),wsComponents.resourceName){const[path,query]=wsComponents.resourceName.split("?");wsComponents.path=path&&"/"!==path?path:void 0,wsComponents.query=query,wsComponents.resourceName=void 0}return wsComponents.fragment=void 0,wsComponents}},SCHEMES={http:http,https:{scheme:"https",domainHost:http.domainHost,parse:httpParse,serialize:httpSerialize},ws:ws,wss:{scheme:"wss",domainHost:ws.domainHost,parse:ws.parse,serialize:ws.serialize},urn:{scheme:"urn",parse:function(urnComponents,options){if(!urnComponents.path)return urnComponents.error="URN can not be parsed",urnComponents;const matches=urnComponents.path.match(URN_REG);if(matches){const scheme=options.scheme||urnComponents.scheme||"urn";urnComponents.nid=matches[1].toLowerCase(),urnComponents.nss=matches[2];const urnScheme=`${scheme}:${options.nid||urnComponents.nid}`,schemeHandler=SCHEMES[urnScheme];urnComponents.path=void 0,schemeHandler&&(urnComponents=schemeHandler.parse(urnComponents,options))}else urnComponents.error=urnComponents.error||"URN can not be parsed.";return urnComponents},serialize:function(urnComponents,options){const scheme=options.scheme||urnComponents.scheme||"urn",nid=urnComponents.nid.toLowerCase(),urnScheme=`${scheme}:${options.nid||nid}`,schemeHandler=SCHEMES[urnScheme];schemeHandler&&(urnComponents=schemeHandler.serialize(urnComponents,options));const uriComponents=urnComponents,nss=urnComponents.nss;return uriComponents.path=`${nid||options.nid}:${nss}`,options.skipEscape=!0,uriComponents},skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:function(urnComponents,options){const uuidComponents=urnComponents;return uuidComponents.uuid=uuidComponents.nss,uuidComponents.nss=void 0,options.tolerant||uuidComponents.uuid&&UUID_REG.test(uuidComponents.uuid)||(uuidComponents.error=uuidComponents.error||"UUID is not valid."),uuidComponents},serialize:function(uuidComponents){const urnComponents=uuidComponents;return urnComponents.nss=(uuidComponents.uuid||"").toLowerCase(),urnComponents},skipNormalize:!0}};return schemes=SCHEMES}();function resolveComponents(base,relative,options,skipNormalization){const target={};return skipNormalization||(base=parse(serialize(base,options),options),relative=parse(serialize(relative,options),options)),!(options=options||{}).tolerant&&relative.scheme?(target.scheme=relative.scheme,target.userinfo=relative.userinfo,target.host=relative.host,target.port=relative.port,target.path=removeDotSegments(relative.path||""),target.query=relative.query):(void 0!==relative.userinfo||void 0!==relative.host||void 0!==relative.port?(target.userinfo=relative.userinfo,target.host=relative.host,target.port=relative.port,target.path=removeDotSegments(relative.path||""),target.query=relative.query):(relative.path?("/"===relative.path.charAt(0)?target.path=removeDotSegments(relative.path):(void 0===base.userinfo&&void 0===base.host&&void 0===base.port||base.path?base.path?target.path=base.path.slice(0,base.path.lastIndexOf("/")+1)+relative.path:target.path=relative.path:target.path="/"+relative.path,target.path=removeDotSegments(target.path)),target.query=relative.query):(target.path=base.path,void 0!==relative.query?target.query=relative.query:target.query=base.query),target.userinfo=base.userinfo,target.host=base.host,target.port=base.port),target.scheme=base.scheme),target.fragment=relative.fragment,target}function serialize(cmpts,opts){const components={host:cmpts.host,scheme:cmpts.scheme,userinfo:cmpts.userinfo,port:cmpts.port,path:cmpts.path,query:cmpts.query,nid:cmpts.nid,nss:cmpts.nss,uuid:cmpts.uuid,fragment:cmpts.fragment,reference:cmpts.reference,resourceName:cmpts.resourceName,secure:cmpts.secure,error:""},options=Object.assign({},opts),uriTokens=[],schemeHandler=SCHEMES[(options.scheme||components.scheme||"").toLowerCase()];schemeHandler&&schemeHandler.serialize&&schemeHandler.serialize(components,options),void 0!==components.path&&(options.skipEscape?components.path=unescape(components.path):(components.path=escape(components.path),void 0!==components.scheme&&(components.path=components.path.split("%3A").join(":")))),"suffix"!==options.reference&&components.scheme&&uriTokens.push(components.scheme,":");const authority=recomposeAuthority(components);if(void 0!==authority&&("suffix"!==options.reference&&uriTokens.push("//"),uriTokens.push(authority),components.path&&"/"!==components.path.charAt(0)&&uriTokens.push("/")),void 0!==components.path){let s=components.path;options.absolutePath||schemeHandler&&schemeHandler.absolutePath||(s=removeDotSegments(s)),void 0===authority&&(s=s.replace(/^\/\//u,"/%2F")),uriTokens.push(s)}return void 0!==components.query&&uriTokens.push("?",components.query),void 0!==components.fragment&&uriTokens.push("#",components.fragment),uriTokens.join("")}const hexLookUp=Array.from({length:127},(_v,k)=>/[^!"$&'()*+,\-.;=_`a-z{}~]/u.test(String.fromCharCode(k))),URI_PARSE=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function parse(uri,opts){const options=Object.assign({},opts),parsed={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0},gotEncoding=-1!==uri.indexOf("%");let isIP=!1;"suffix"===options.reference&&(uri=(options.scheme?options.scheme+":":"")+"//"+uri);const matches=uri.match(URI_PARSE);if(matches){if(parsed.scheme=matches[1],parsed.userinfo=matches[3],parsed.host=matches[4],parsed.port=parseInt(matches[5],10),parsed.path=matches[6]||"",parsed.query=matches[7],parsed.fragment=matches[8],isNaN(parsed.port)&&(parsed.port=matches[5]),parsed.host){const ipv4result=normalizeIPv4(parsed.host);if(!1===ipv4result.isIPV4){const ipv6result=normalizeIPv6(ipv4result.host);parsed.host=ipv6result.host.toLowerCase(),isIP=ipv6result.isIPV6}else parsed.host=ipv4result.host,isIP=!0}void 0!==parsed.scheme||void 0!==parsed.userinfo||void 0!==parsed.host||void 0!==parsed.port||void 0!==parsed.query||parsed.path?void 0===parsed.scheme?parsed.reference="relative":void 0===parsed.fragment?parsed.reference="absolute":parsed.reference="uri":parsed.reference="same-document",options.reference&&"suffix"!==options.reference&&options.reference!==parsed.reference&&(parsed.error=parsed.error||"URI is not a "+options.reference+" reference.");const schemeHandler=SCHEMES[(options.scheme||parsed.scheme||"").toLowerCase()];if(!(options.unicodeSupport||schemeHandler&&schemeHandler.unicodeSupport)&&parsed.host&&(options.domainHost||schemeHandler&&schemeHandler.domainHost)&&!1===isIP&&function(value){let code=0;for(let i=0,len=value.length;i<len;++i)if(code=value.charCodeAt(i),code>126||hexLookUp[code])return!0;return!1}(parsed.host))try{parsed.host=URL.domainToASCII(parsed.host.toLowerCase())}catch(e){parsed.error=parsed.error||"Host's domain name can not be converted to ASCII: "+e}(!schemeHandler||schemeHandler&&!schemeHandler.skipNormalize)&&(gotEncoding&&void 0!==parsed.scheme&&(parsed.scheme=unescape(parsed.scheme)),gotEncoding&&void 0!==parsed.host&&(parsed.host=unescape(parsed.host)),parsed.path&&(parsed.path=escape(unescape(parsed.path))),parsed.fragment&&(parsed.fragment=encodeURI(decodeURIComponent(parsed.fragment)))),schemeHandler&&schemeHandler.parse&&schemeHandler.parse(parsed,options)}else parsed.error=parsed.error||"URI can not be parsed.";return parsed}const fastUri$1={SCHEMES:SCHEMES,normalize:function(uri,options){return"string"==typeof uri?uri=serialize(parse(uri,options),options):"object"==typeof uri&&(uri=parse(serialize(uri,options),options)),uri},resolve:function(baseURI,relativeURI,options){const schemelessOptions=Object.assign({scheme:"null"},options);return serialize(resolveComponents(parse(baseURI,schemelessOptions),parse(relativeURI,schemelessOptions),schemelessOptions,!0),{...schemelessOptions,skipEscape:!0})},resolveComponents:resolveComponents,equal:function(uriA,uriB,options){return"string"==typeof uriA?(uriA=unescape(uriA),uriA=serialize(normalizeComponentEncoding(parse(uriA,options),!0),{...options,skipEscape:!0})):"object"==typeof uriA&&(uriA=serialize(normalizeComponentEncoding(uriA,!0),{...options,skipEscape:!0})),"string"==typeof uriB?(uriB=unescape(uriB),uriB=serialize(normalizeComponentEncoding(parse(uriB,options),!0),{...options,skipEscape:!0})):"object"==typeof uriB&&(uriB=serialize(normalizeComponentEncoding(uriB,!0),{...options,skipEscape:!0})),uriA.toLowerCase()===uriB.toLowerCase()},serialize:serialize,parse:parse};return fastUri.exports=fastUri$1,fastUri.exports.default=fastUri$1,fastUri.exports.fastUri=fastUri$1,fastUri.exports}function requireCore$1(){return hasRequiredCore$1||(hasRequiredCore$1=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=void 0;var validate_1=requireValidate();Object.defineProperty(exports,"KeywordCxt",{enumerable:!0,get:function(){return validate_1.KeywordCxt}});var codegen_1=requireCodegen();Object.defineProperty(exports,"_",{enumerable:!0,get:function(){return codegen_1._}}),Object.defineProperty(exports,"str",{enumerable:!0,get:function(){return codegen_1.str}}),Object.defineProperty(exports,"stringify",{enumerable:!0,get:function(){return codegen_1.stringify}}),Object.defineProperty(exports,"nil",{enumerable:!0,get:function(){return codegen_1.nil}}),Object.defineProperty(exports,"Name",{enumerable:!0,get:function(){return codegen_1.Name}}),Object.defineProperty(exports,"CodeGen",{enumerable:!0,get:function(){return codegen_1.CodeGen}});const validation_error_1=requireValidation_error(),ref_error_1=requireRef_error(),rules_1=requireRules(),compile_1=requireCompile(),codegen_2=requireCodegen(),resolve_1=requireResolve(),dataType_1=requireDataType(),util_1=requireUtil(),$dataRefSchema=require$$9,uri_1=function(){if(hasRequiredUri)return uri;hasRequiredUri=1,Object.defineProperty(uri,"__esModule",{value:!0});const uri$1=requireFastUri();return uri$1.code='require("ajv/dist/runtime/uri").default',uri.default=uri$1,uri}(),defaultRegExp=(str,flags)=>new RegExp(str,flags);defaultRegExp.code="new RegExp";const META_IGNORE_OPTIONS=["removeAdditional","useDefaults","coerceTypes"],EXT_SCOPE_NAMES=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),removedOptions={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},deprecatedOptions={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function requiredOptions(o){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k,_l,_m,_o,_p,_q,_r,_s,_t,_u,_v,_w,_x,_y,_z,_0;const s=o.strict,_optz=null===(_a=o.code)||void 0===_a?void 0:_a.optimize,optimize=!0===_optz||void 0===_optz?1:_optz||0,regExp=null!==(_c=null===(_b=o.code)||void 0===_b?void 0:_b.regExp)&&void 0!==_c?_c:defaultRegExp,uriResolver=null!==(_d=o.uriResolver)&&void 0!==_d?_d:uri_1.default;return{strictSchema:null===(_f=null!==(_e=o.strictSchema)&&void 0!==_e?_e:s)||void 0===_f||_f,strictNumbers:null===(_h=null!==(_g=o.strictNumbers)&&void 0!==_g?_g:s)||void 0===_h||_h,strictTypes:null!==(_k=null!==(_j=o.strictTypes)&&void 0!==_j?_j:s)&&void 0!==_k?_k:"log",strictTuples:null!==(_m=null!==(_l=o.strictTuples)&&void 0!==_l?_l:s)&&void 0!==_m?_m:"log",strictRequired:null!==(_p=null!==(_o=o.strictRequired)&&void 0!==_o?_o:s)&&void 0!==_p&&_p,code:o.code?{...o.code,optimize:optimize,regExp:regExp}:{optimize:optimize,regExp:regExp},loopRequired:null!==(_q=o.loopRequired)&&void 0!==_q?_q:200,loopEnum:null!==(_r=o.loopEnum)&&void 0!==_r?_r:200,meta:null===(_s=o.meta)||void 0===_s||_s,messages:null===(_t=o.messages)||void 0===_t||_t,inlineRefs:null===(_u=o.inlineRefs)||void 0===_u||_u,schemaId:null!==(_v=o.schemaId)&&void 0!==_v?_v:"$id",addUsedSchema:null===(_w=o.addUsedSchema)||void 0===_w||_w,validateSchema:null===(_x=o.validateSchema)||void 0===_x||_x,validateFormats:null===(_y=o.validateFormats)||void 0===_y||_y,unicodeRegExp:null===(_z=o.unicodeRegExp)||void 0===_z||_z,int32range:null===(_0=o.int32range)||void 0===_0||_0,uriResolver:uriResolver}}class Ajv{constructor(opts={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,opts=this.opts={...opts,...requiredOptions(opts)};const{es5:es5,lines:lines}=this.opts.code;this.scope=new codegen_2.ValueScope({scope:{},prefixes:EXT_SCOPE_NAMES,es5:es5,lines:lines}),this.logger=function(logger){if(!1===logger)return noLogs;if(void 0===logger)return console;if(logger.log&&logger.warn&&logger.error)return logger;throw new Error("logger must implement log, warn and error methods")}(opts.logger);const formatOpt=opts.validateFormats;opts.validateFormats=!1,this.RULES=(0,rules_1.getRules)(),checkOptions.call(this,removedOptions,opts,"NOT SUPPORTED"),checkOptions.call(this,deprecatedOptions,opts,"DEPRECATED","warn"),this._metaOpts=getMetaSchemaOptions.call(this),opts.formats&&addInitialFormats.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),opts.keywords&&addInitialKeywords.call(this,opts.keywords),"object"==typeof opts.meta&&this.addMetaSchema(opts.meta),addInitialSchemas.call(this),opts.validateFormats=formatOpt}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:$data,meta:meta,schemaId:schemaId}=this.opts;let _dataRefSchema=$dataRefSchema;"id"===schemaId&&(_dataRefSchema={...$dataRefSchema},_dataRefSchema.id=_dataRefSchema.$id,delete _dataRefSchema.$id),meta&&$data&&this.addMetaSchema(_dataRefSchema,_dataRefSchema[schemaId],!1)}defaultMeta(){const{meta:meta,schemaId:schemaId}=this.opts;return this.opts.defaultMeta="object"==typeof meta?meta[schemaId]||meta:void 0}validate(schemaKeyRef,data){let v;if("string"==typeof schemaKeyRef){if(v=this.getSchema(schemaKeyRef),!v)throw new Error(`no schema with key or ref "${schemaKeyRef}"`)}else v=this.compile(schemaKeyRef);const valid=v(data);return"$async"in v||(this.errors=v.errors),valid}compile(schema,_meta){const sch=this._addSchema(schema,_meta);return sch.validate||this._compileSchemaEnv(sch)}compileAsync(schema,meta){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:loadSchema}=this.opts;return runCompileAsync.call(this,schema,meta);async function runCompileAsync(_schema,_meta){await loadMetaSchema.call(this,_schema.$schema);const sch=this._addSchema(_schema,_meta);return sch.validate||_compileAsync.call(this,sch)}async function loadMetaSchema($ref){$ref&&!this.getSchema($ref)&&await runCompileAsync.call(this,{$ref:$ref},!0)}async function _compileAsync(sch){try{return this._compileSchemaEnv(sch)}catch(e){if(!(e instanceof ref_error_1.default))throw e;return checkLoaded.call(this,e),await loadMissingSchema.call(this,e.missingSchema),_compileAsync.call(this,sch)}}function checkLoaded({missingSchema:ref,missingRef:missingRef}){if(this.refs[ref])throw new Error(`AnySchema ${ref} is loaded but ${missingRef} cannot be resolved`)}async function loadMissingSchema(ref){const _schema=await _loadSchema.call(this,ref);this.refs[ref]||await loadMetaSchema.call(this,_schema.$schema),this.refs[ref]||this.addSchema(_schema,ref,meta)}async function _loadSchema(ref){const p=this._loading[ref];if(p)return p;try{return await(this._loading[ref]=loadSchema(ref))}finally{delete this._loading[ref]}}}addSchema(schema,key,_meta,_validateSchema=this.opts.validateSchema){if(Array.isArray(schema)){for(const sch of schema)this.addSchema(sch,void 0,_meta,_validateSchema);return this}let id;if("object"==typeof schema){const{schemaId:schemaId}=this.opts;if(id=schema[schemaId],void 0!==id&&"string"!=typeof id)throw new Error(`schema ${schemaId} must be string`)}return key=(0,resolve_1.normalizeId)(key||id),this._checkUnique(key),this.schemas[key]=this._addSchema(schema,_meta,key,_validateSchema,!0),this}addMetaSchema(schema,key,_validateSchema=this.opts.validateSchema){return this.addSchema(schema,key,!0,_validateSchema),this}validateSchema(schema,throwOrLogError){if("boolean"==typeof schema)return!0;let $schema;if($schema=schema.$schema,void 0!==$schema&&"string"!=typeof $schema)throw new Error("$schema must be a string");if($schema=$schema||this.opts.defaultMeta||this.defaultMeta(),!$schema)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const valid=this.validate($schema,schema);if(!valid&&throwOrLogError){const message="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(message);this.logger.error(message)}return valid}getSchema(keyRef){let sch;for(;"string"==typeof(sch=getSchEnv.call(this,keyRef));)keyRef=sch;if(void 0===sch){const{schemaId:schemaId}=this.opts,root=new compile_1.SchemaEnv({schema:{},schemaId:schemaId});if(sch=compile_1.resolveSchema.call(this,root,keyRef),!sch)return;this.refs[keyRef]=sch}return sch.validate||this._compileSchemaEnv(sch)}removeSchema(schemaKeyRef){if(schemaKeyRef instanceof RegExp)return this._removeAllSchemas(this.schemas,schemaKeyRef),this._removeAllSchemas(this.refs,schemaKeyRef),this;switch(typeof schemaKeyRef){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const sch=getSchEnv.call(this,schemaKeyRef);return"object"==typeof sch&&this._cache.delete(sch.schema),delete this.schemas[schemaKeyRef],delete this.refs[schemaKeyRef],this}case"object":{const cacheKey=schemaKeyRef;this._cache.delete(cacheKey);let id=schemaKeyRef[this.opts.schemaId];return id&&(id=(0,resolve_1.normalizeId)(id),delete this.schemas[id],delete this.refs[id]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(definitions){for(const def of definitions)this.addKeyword(def);return this}addKeyword(kwdOrDef,def){let keyword;if("string"==typeof kwdOrDef)keyword=kwdOrDef,"object"==typeof def&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),def.keyword=keyword);else{if("object"!=typeof kwdOrDef||void 0!==def)throw new Error("invalid addKeywords parameters");if(keyword=(def=kwdOrDef).keyword,Array.isArray(keyword)&&!keyword.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(checkKeyword.call(this,keyword,def),!def)return(0,util_1.eachItem)(keyword,kwd=>addRule.call(this,kwd)),this;keywordMetaschema.call(this,def);const definition={...def,type:(0,dataType_1.getJSONTypes)(def.type),schemaType:(0,dataType_1.getJSONTypes)(def.schemaType)};return(0,util_1.eachItem)(keyword,0===definition.type.length?k=>addRule.call(this,k,definition):k=>definition.type.forEach(t=>addRule.call(this,k,definition,t))),this}getKeyword(keyword){const rule=this.RULES.all[keyword];return"object"==typeof rule?rule.definition:!!rule}removeKeyword(keyword){const{RULES:RULES}=this;delete RULES.keywords[keyword],delete RULES.all[keyword];for(const group of RULES.rules){const i=group.rules.findIndex(rule=>rule.keyword===keyword);i>=0&&group.rules.splice(i,1)}return this}addFormat(name,format){return"string"==typeof format&&(format=new RegExp(format)),this.formats[name]=format,this}errorsText(errors=this.errors,{separator:separator=", ",dataVar:dataVar="data"}={}){return errors&&0!==errors.length?errors.map(e=>`${dataVar}${e.instancePath} ${e.message}`).reduce((text,msg)=>text+separator+msg):"No errors"}$dataMetaSchema(metaSchema,keywordsJsonPointers){const rules=this.RULES.all;metaSchema=JSON.parse(JSON.stringify(metaSchema));for(const jsonPointer of keywordsJsonPointers){const segments=jsonPointer.split("/").slice(1);let keywords=metaSchema;for(const seg of segments)keywords=keywords[seg];for(const key in rules){const rule=rules[key];if("object"!=typeof rule)continue;const{$data:$data}=rule.definition,schema=keywords[key];$data&&schema&&(keywords[key]=schemaOrData(schema))}}return metaSchema}_removeAllSchemas(schemas,regex){for(const keyRef in schemas){const sch=schemas[keyRef];regex&&!regex.test(keyRef)||("string"==typeof sch?delete schemas[keyRef]:sch&&!sch.meta&&(this._cache.delete(sch.schema),delete schemas[keyRef]))}}_addSchema(schema,meta,baseId,validateSchema=this.opts.validateSchema,addSchema=this.opts.addUsedSchema){let id;const{schemaId:schemaId}=this.opts;if("object"==typeof schema)id=schema[schemaId];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof schema)throw new Error("schema must be object or boolean")}let sch=this._cache.get(schema);if(void 0!==sch)return sch;baseId=(0,resolve_1.normalizeId)(id||baseId);const localRefs=resolve_1.getSchemaRefs.call(this,schema,baseId);return sch=new compile_1.SchemaEnv({schema:schema,schemaId:schemaId,meta:meta,baseId:baseId,localRefs:localRefs}),this._cache.set(sch.schema,sch),addSchema&&!baseId.startsWith("#")&&(baseId&&this._checkUnique(baseId),this.refs[baseId]=sch),validateSchema&&this.validateSchema(schema,!0),sch}_checkUnique(id){if(this.schemas[id]||this.refs[id])throw new Error(`schema with key or id "${id}" already exists`)}_compileSchemaEnv(sch){if(sch.meta?this._compileMetaSchema(sch):compile_1.compileSchema.call(this,sch),!sch.validate)throw new Error("ajv implementation error");return sch.validate}_compileMetaSchema(sch){const currentOpts=this.opts;this.opts=this._metaOpts;try{compile_1.compileSchema.call(this,sch)}finally{this.opts=currentOpts}}}function checkOptions(checkOpts,options,msg,log="error"){for(const key in checkOpts){const opt=key;opt in options&&this.logger[log](`${msg}: option ${key}. ${checkOpts[opt]}`)}}function getSchEnv(keyRef){return keyRef=(0,resolve_1.normalizeId)(keyRef),this.schemas[keyRef]||this.refs[keyRef]}function addInitialSchemas(){const optsSchemas=this.opts.schemas;if(optsSchemas)if(Array.isArray(optsSchemas))this.addSchema(optsSchemas);else for(const key in optsSchemas)this.addSchema(optsSchemas[key],key)}function addInitialFormats(){for(const name in this.opts.formats){const format=this.opts.formats[name];format&&this.addFormat(name,format)}}function addInitialKeywords(defs){if(Array.isArray(defs))this.addVocabulary(defs);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const keyword in defs){const def=defs[keyword];def.keyword||(def.keyword=keyword),this.addKeyword(def)}}}function getMetaSchemaOptions(){const metaOpts={...this.opts};for(const opt of META_IGNORE_OPTIONS)delete metaOpts[opt];return metaOpts}Ajv.ValidationError=validation_error_1.default,Ajv.MissingRefError=ref_error_1.default,exports.default=Ajv;const noLogs={log(){},warn(){},error(){}},KEYWORD_NAME=/^[a-z_$][a-z0-9_$:-]*$/i;function checkKeyword(keyword,def){const{RULES:RULES}=this;if((0,util_1.eachItem)(keyword,kwd=>{if(RULES.keywords[kwd])throw new Error(`Keyword ${kwd} is already defined`);if(!KEYWORD_NAME.test(kwd))throw new Error(`Keyword ${kwd} has invalid name`)}),def&&def.$data&&!("code"in def)&&!("validate"in def))throw new Error('$data keyword must have "code" or "validate" function')}function addRule(keyword,definition,dataType){var _a;const post=null==definition?void 0:definition.post;if(dataType&&post)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:RULES}=this;let ruleGroup=post?RULES.post:RULES.rules.find(({type:t})=>t===dataType);if(ruleGroup||(ruleGroup={type:dataType,rules:[]},RULES.rules.push(ruleGroup)),RULES.keywords[keyword]=!0,!definition)return;const rule={keyword:keyword,definition:{...definition,type:(0,dataType_1.getJSONTypes)(definition.type),schemaType:(0,dataType_1.getJSONTypes)(definition.schemaType)}};definition.before?addBeforeRule.call(this,ruleGroup,rule,definition.before):ruleGroup.rules.push(rule),RULES.all[keyword]=rule,null===(_a=definition.implements)||void 0===_a||_a.forEach(kwd=>this.addKeyword(kwd))}function addBeforeRule(ruleGroup,rule,before){const i=ruleGroup.rules.findIndex(_rule=>_rule.keyword===before);i>=0?ruleGroup.rules.splice(i,0,rule):(ruleGroup.rules.push(rule),this.logger.warn(`rule ${before} is not defined`))}function keywordMetaschema(def){let{metaSchema:metaSchema}=def;void 0!==metaSchema&&(def.$data&&this.opts.$data&&(metaSchema=schemaOrData(metaSchema)),def.validateSchema=this.compile(metaSchema,!0))}const $dataRef={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function schemaOrData(schema){return{anyOf:[schema,$dataRef]}}}(core$1)),core$1}var hasRequiredId,hasRequiredRef,hasRequiredCore,draft7={},core={},id={},ref={};var hasRequiredLimitNumber,hasRequiredMultipleOf,hasRequiredUcs2length,hasRequiredLimitLength,validation={},limitNumber={},multipleOf={},limitLength={},ucs2length={};var hasRequiredPattern,hasRequiredLimitProperties,hasRequiredRequired,pattern={},limitProperties={},required={};var hasRequiredLimitItems,hasRequiredEqual,hasRequiredUniqueItems,limitItems={},uniqueItems={},equal={};function requireEqual(){if(hasRequiredEqual)return equal;hasRequiredEqual=1,Object.defineProperty(equal,"__esModule",{value:!0});const equal$1=requireFastDeepEqual();return equal$1.code='require("ajv/dist/runtime/equal").default',equal.default=equal$1,equal}function requireUniqueItems(){if(hasRequiredUniqueItems)return uniqueItems;hasRequiredUniqueItems=1,Object.defineProperty(uniqueItems,"__esModule",{value:!0});const dataType_1=requireDataType(),codegen_1=requireCodegen(),util_1=requireUtil(),equal_1=requireEqual(),def={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:i,j:j}})=>codegen_1.str`must NOT have duplicate items (items ## ${j} and ${i} are identical)`,params:({params:{i:i,j:j}})=>codegen_1._`{i: ${i}, j: ${j}}`},code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,parentSchema:parentSchema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&!schema)return;const valid=gen.let("valid"),itemTypes=parentSchema.items?(0,dataType_1.getSchemaTypes)(parentSchema.items):[];function loopN(i,j){const item=gen.name("item"),wrongType=(0,dataType_1.checkDataTypes)(itemTypes,item,it.opts.strictNumbers,dataType_1.DataType.Wrong),indices=gen.const("indices",codegen_1._`{}`);gen.for(codegen_1._`;${i}--;`,()=>{gen.let(item,codegen_1._`${data}[${i}]`),gen.if(wrongType,codegen_1._`continue`),itemTypes.length>1&&gen.if(codegen_1._`typeof ${item} == "string"`,codegen_1._`${item} += "_"`),gen.if(codegen_1._`typeof ${indices}[${item}] == "number"`,()=>{gen.assign(j,codegen_1._`${indices}[${item}]`),cxt.error(),gen.assign(valid,!1).break()}).code(codegen_1._`${indices}[${item}] = ${i}`)})}function loopN2(i,j){const eql=(0,util_1.useFunc)(gen,equal_1.default),outer=gen.name("outer");gen.label(outer).for(codegen_1._`;${i}--;`,()=>gen.for(codegen_1._`${j} = ${i}; ${j}--;`,()=>gen.if(codegen_1._`${eql}(${data}[${i}], ${data}[${j}])`,()=>{cxt.error(),gen.assign(valid,!1).break(outer)})))}cxt.block$data(valid,function(){const i=gen.let("i",codegen_1._`${data}.length`),j=gen.let("j");cxt.setParams({i:i,j:j}),gen.assign(valid,!0),gen.if(codegen_1._`${i} > 1`,()=>(itemTypes.length>0&&!itemTypes.some(t=>"object"===t||"array"===t)?loopN:loopN2)(i,j))},codegen_1._`${schemaCode} === false`),cxt.ok(valid)}};return uniqueItems.default=def,uniqueItems}var hasRequired_const,hasRequired_enum,hasRequiredValidation,_const={},_enum={};function requireValidation(){if(hasRequiredValidation)return validation;hasRequiredValidation=1,Object.defineProperty(validation,"__esModule",{value:!0});const limitNumber_1=function(){if(hasRequiredLimitNumber)return limitNumber;hasRequiredLimitNumber=1,Object.defineProperty(limitNumber,"__esModule",{value:!0});const codegen_1=requireCodegen(),ops=codegen_1.operators,KWDs={maximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},minimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},exclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},exclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}},error={message:({keyword:keyword,schemaCode:schemaCode})=>codegen_1.str`must be ${KWDs[keyword].okStr} ${schemaCode}`,params:({keyword:keyword,schemaCode:schemaCode})=>codegen_1._`{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`},def={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:!0,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt;cxt.fail$data(codegen_1._`${data} ${KWDs[keyword].fail} ${schemaCode} || isNaN(${data})`)}};return limitNumber.default=def,limitNumber}(),multipleOf_1=function(){if(hasRequiredMultipleOf)return multipleOf;hasRequiredMultipleOf=1,Object.defineProperty(multipleOf,"__esModule",{value:!0});const codegen_1=requireCodegen(),def={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:schemaCode})=>codegen_1.str`must be multiple of ${schemaCode}`,params:({schemaCode:schemaCode})=>codegen_1._`{multipleOf: ${schemaCode}}`},code(cxt){const{gen:gen,data:data,schemaCode:schemaCode,it:it}=cxt,prec=it.opts.multipleOfPrecision,res=gen.let("res"),invalid=prec?codegen_1._`Math.abs(Math.round(${res}) - ${res}) > 1e-${prec}`:codegen_1._`${res} !== parseInt(${res})`;cxt.fail$data(codegen_1._`(${schemaCode} === 0 || (${res} = ${data}/${schemaCode}, ${invalid}))`)}};return multipleOf.default=def,multipleOf}(),limitLength_1=function(){if(hasRequiredLimitLength)return limitLength;hasRequiredLimitLength=1,Object.defineProperty(limitLength,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),ucs2length_1=function(){if(hasRequiredUcs2length)return ucs2length;function ucs2length$1(str){const len=str.length;let value,length=0,pos=0;for(;pos<len;)length++,value=str.charCodeAt(pos++),value>=55296&&value<=56319&&pos<len&&(value=str.charCodeAt(pos),56320==(64512&value)&&pos++);return length}return hasRequiredUcs2length=1,Object.defineProperty(ucs2length,"__esModule",{value:!0}),ucs2length.default=ucs2length$1,ucs2length$1.code='require("ajv/dist/runtime/ucs2length").default',ucs2length}(),error={message({keyword:keyword,schemaCode:schemaCode}){const comp="maxLength"===keyword?"more":"fewer";return codegen_1.str`must NOT have ${comp} than ${schemaCode} characters`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`},def={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode,it:it}=cxt,op="maxLength"===keyword?codegen_1.operators.GT:codegen_1.operators.LT,len=!1===it.opts.unicode?codegen_1._`${data}.length`:codegen_1._`${(0,util_1.useFunc)(cxt.gen,ucs2length_1.default)}(${data})`;cxt.fail$data(codegen_1._`${len} ${op} ${schemaCode}`)}};return limitLength.default=def,limitLength}(),pattern_1=function(){if(hasRequiredPattern)return pattern;hasRequiredPattern=1,Object.defineProperty(pattern,"__esModule",{value:!0});const code_1=requireCode(),codegen_1=requireCodegen(),def={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:schemaCode})=>codegen_1.str`must match pattern "${schemaCode}"`,params:({schemaCode:schemaCode})=>codegen_1._`{pattern: ${schemaCode}}`},code(cxt){const{data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt,u=it.opts.unicodeRegExp?"u":"",regExp=$data?codegen_1._`(new RegExp(${schemaCode}, ${u}))`:(0,code_1.usePattern)(cxt,schema);cxt.fail$data(codegen_1._`!${regExp}.test(${data})`)}};return pattern.default=def,pattern}(),limitProperties_1=function(){if(hasRequiredLimitProperties)return limitProperties;hasRequiredLimitProperties=1,Object.defineProperty(limitProperties,"__esModule",{value:!0});const codegen_1=requireCodegen(),error={message({keyword:keyword,schemaCode:schemaCode}){const comp="maxProperties"===keyword?"more":"fewer";return codegen_1.str`must NOT have ${comp} than ${schemaCode} properties`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`},def={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt,op="maxProperties"===keyword?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data(codegen_1._`Object.keys(${data}).length ${op} ${schemaCode}`)}};return limitProperties.default=def,limitProperties}(),required_1=function(){if(hasRequiredRequired)return required;hasRequiredRequired=1,Object.defineProperty(required,"__esModule",{value:!0});const code_1=requireCode(),codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:missingProperty}})=>codegen_1.str`must have required property '${missingProperty}'`,params:({params:{missingProperty:missingProperty}})=>codegen_1._`{missingProperty: ${missingProperty}}`},code(cxt){const{gen:gen,schema:schema,schemaCode:schemaCode,data:data,$data:$data,it:it}=cxt,{opts:opts}=it;if(!$data&&0===schema.length)return;const useLoop=schema.length>=opts.loopRequired;if(it.allErrors?function(){if(useLoop||$data)cxt.block$data(codegen_1.nil,loopAllRequired);else for(const prop of schema)(0,code_1.checkReportMissingProp)(cxt,prop)}():function(){const missing=gen.let("missing");if(useLoop||$data){const valid=gen.let("valid",!0);cxt.block$data(valid,()=>function(missing,valid){cxt.setParams({missingProperty:missing}),gen.forOf(missing,schemaCode,()=>{gen.assign(valid,(0,code_1.propertyInData)(gen,data,missing,opts.ownProperties)),gen.if((0,codegen_1.not)(valid),()=>{cxt.error(),gen.break()})},codegen_1.nil)}(missing,valid)),cxt.ok(valid)}else gen.if((0,code_1.checkMissingProp)(cxt,schema,missing)),(0,code_1.reportMissingProp)(cxt,missing),gen.else()}(),opts.strictRequired){const props=cxt.parentSchema.properties,{definedProperties:definedProperties}=cxt.it;for(const requiredKey of schema)if(void 0===(null==props?void 0:props[requiredKey])&&!definedProperties.has(requiredKey)){const msg=`required property "${requiredKey}" is not defined at "${it.schemaEnv.baseId+it.errSchemaPath}" (strictRequired)`;(0,util_1.checkStrictMode)(it,msg,it.opts.strictRequired)}}function loopAllRequired(){gen.forOf("prop",schemaCode,prop=>{cxt.setParams({missingProperty:prop}),gen.if((0,code_1.noPropertyInData)(gen,data,prop,opts.ownProperties),()=>cxt.error())})}}};return required.default=def,required}(),limitItems_1=function(){if(hasRequiredLimitItems)return limitItems;hasRequiredLimitItems=1,Object.defineProperty(limitItems,"__esModule",{value:!0});const codegen_1=requireCodegen(),error={message({keyword:keyword,schemaCode:schemaCode}){const comp="maxItems"===keyword?"more":"fewer";return codegen_1.str`must NOT have ${comp} than ${schemaCode} items`},params:({schemaCode:schemaCode})=>codegen_1._`{limit: ${schemaCode}}`},def={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:error,code(cxt){const{keyword:keyword,data:data,schemaCode:schemaCode}=cxt,op="maxItems"===keyword?codegen_1.operators.GT:codegen_1.operators.LT;cxt.fail$data(codegen_1._`${data}.length ${op} ${schemaCode}`)}};return limitItems.default=def,limitItems}(),uniqueItems_1=requireUniqueItems(),const_1=function(){if(hasRequired_const)return _const;hasRequired_const=1,Object.defineProperty(_const,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),equal_1=requireEqual(),def={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:schemaCode})=>codegen_1._`{allowedValue: ${schemaCode}}`},code(cxt){const{gen:gen,data:data,$data:$data,schemaCode:schemaCode,schema:schema}=cxt;$data||schema&&"object"==typeof schema?cxt.fail$data(codegen_1._`!${(0,util_1.useFunc)(gen,equal_1.default)}(${data}, ${schemaCode})`):cxt.fail(codegen_1._`${schema} !== ${data}`)}};return _const.default=def,_const}(),enum_1=function(){if(hasRequired_enum)return _enum;hasRequired_enum=1,Object.defineProperty(_enum,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),equal_1=requireEqual(),def={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:schemaCode})=>codegen_1._`{allowedValues: ${schemaCode}}`},code(cxt){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt;if(!$data&&0===schema.length)throw new Error("enum must have non-empty array");const useLoop=schema.length>=it.opts.loopEnum;let eql;const getEql=()=>null!=eql?eql:eql=(0,util_1.useFunc)(gen,equal_1.default);let valid;if(useLoop||$data)valid=gen.let("valid"),cxt.block$data(valid,function(){gen.assign(valid,!1),gen.forOf("v",schemaCode,v=>gen.if(codegen_1._`${getEql()}(${data}, ${v})`,()=>gen.assign(valid,!0).break()))});else{if(!Array.isArray(schema))throw new Error("ajv implementation error");const vSchema=gen.const("vSchema",schemaCode);valid=(0,codegen_1.or)(...schema.map((_x,i)=>function(vSchema,i){const sch=schema[i];return"object"==typeof sch&&null!==sch?codegen_1._`${getEql()}(${data}, ${vSchema}[${i}])`:codegen_1._`${data} === ${sch}`}(vSchema,i)))}cxt.pass(valid)}};return _enum.default=def,_enum}(),validation$1=[limitNumber_1.default,multipleOf_1.default,limitLength_1.default,pattern_1.default,limitProperties_1.default,required_1.default,limitItems_1.default,uniqueItems_1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},const_1.default,enum_1.default];return validation.default=validation$1,validation}var hasRequiredAdditionalItems,applicator={},additionalItems={};function requireAdditionalItems(){if(hasRequiredAdditionalItems)return additionalItems;hasRequiredAdditionalItems=1,Object.defineProperty(additionalItems,"__esModule",{value:!0}),additionalItems.validateAdditionalItems=void 0;const codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:len}})=>codegen_1.str`must NOT have more than ${len} items`,params:({params:{len:len}})=>codegen_1._`{limit: ${len}}`},code(cxt){const{parentSchema:parentSchema,it:it}=cxt,{items:items}=parentSchema;Array.isArray(items)?validateAdditionalItems(cxt,items):(0,util_1.checkStrictMode)(it,'"additionalItems" is ignored when "items" is not an array of schemas')}};function validateAdditionalItems(cxt,items){const{gen:gen,schema:schema,data:data,keyword:keyword,it:it}=cxt;it.items=!0;const len=gen.const("len",codegen_1._`${data}.length`);if(!1===schema)cxt.setParams({len:items.length}),cxt.pass(codegen_1._`${len} <= ${items.length}`);else if("object"==typeof schema&&!(0,util_1.alwaysValidSchema)(it,schema)){const valid=gen.var("valid",codegen_1._`${len} <= ${items.length}`);gen.if((0,codegen_1.not)(valid),()=>function(valid){gen.forRange("i",items.length,len,i=>{cxt.subschema({keyword:keyword,dataProp:i,dataPropType:util_1.Type.Num},valid),it.allErrors||gen.if((0,codegen_1.not)(valid),()=>gen.break())})}(valid)),cxt.ok(valid)}}return additionalItems.validateAdditionalItems=validateAdditionalItems,additionalItems.default=def,additionalItems}var hasRequiredItems,hasRequiredPrefixItems,prefixItems={},items={};function requireItems(){if(hasRequiredItems)return items;hasRequiredItems=1,Object.defineProperty(items,"__esModule",{value:!0}),items.validateTuple=void 0;const codegen_1=requireCodegen(),util_1=requireUtil(),code_1=requireCode(),def={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(cxt){const{schema:schema,it:it}=cxt;if(Array.isArray(schema))return validateTuple(cxt,"additionalItems",schema);it.items=!0,(0,util_1.alwaysValidSchema)(it,schema)||cxt.ok((0,code_1.validateArray)(cxt))}};function validateTuple(cxt,extraItems,schArr=cxt.schema){const{gen:gen,parentSchema:parentSchema,data:data,keyword:keyword,it:it}=cxt;!function(sch){const{opts:opts,errSchemaPath:errSchemaPath}=it,l=schArr.length,fullTuple=l===sch.minItems&&(l===sch.maxItems||!1===sch[extraItems]);if(opts.strictTuples&&!fullTuple){const msg=`"${keyword}" is ${l}-tuple, but minItems or maxItems/${extraItems} are not specified or different at path "${errSchemaPath}"`;(0,util_1.checkStrictMode)(it,msg,opts.strictTuples)}}(parentSchema),it.opts.unevaluated&&schArr.length&&!0!==it.items&&(it.items=util_1.mergeEvaluated.items(gen,schArr.length,it.items));const valid=gen.name("valid"),len=gen.const("len",codegen_1._`${data}.length`);schArr.forEach((sch,i)=>{(0,util_1.alwaysValidSchema)(it,sch)||(gen.if(codegen_1._`${len} > ${i}`,()=>cxt.subschema({keyword:keyword,schemaProp:i,dataProp:i},valid)),cxt.ok(valid))})}return items.validateTuple=validateTuple,items.default=def,items}var hasRequiredItems2020,hasRequiredContains,items2020={},contains={};var hasRequiredDependencies,dependencies={};var hasRequiredPropertyNames,hasRequiredAdditionalProperties,propertyNames={},additionalProperties={};function requireAdditionalProperties(){if(hasRequiredAdditionalProperties)return additionalProperties;hasRequiredAdditionalProperties=1,Object.defineProperty(additionalProperties,"__esModule",{value:!0});const code_1=requireCode(),codegen_1=requireCodegen(),names_1=requireNames(),util_1=requireUtil(),def={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:params})=>codegen_1._`{additionalProperty: ${params.additionalProperty}}`},code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,errsCount:errsCount,it:it}=cxt;if(!errsCount)throw new Error("ajv implementation error");const{allErrors:allErrors,opts:opts}=it;if(it.props=!0,"all"!==opts.removeAdditional&&(0,util_1.alwaysValidSchema)(it,schema))return;const props=(0,code_1.allSchemaProperties)(parentSchema.properties),patProps=(0,code_1.allSchemaProperties)(parentSchema.patternProperties);function deleteAdditional(key){gen.code(codegen_1._`delete ${data}[${key}]`)}function additionalPropertyCode(key){if("all"===opts.removeAdditional||opts.removeAdditional&&!1===schema)deleteAdditional(key);else{if(!1===schema)return cxt.setParams({additionalProperty:key}),cxt.error(),void(allErrors||gen.break());if("object"==typeof schema&&!(0,util_1.alwaysValidSchema)(it,schema)){const valid=gen.name("valid");"failing"===opts.removeAdditional?(applyAdditionalSchema(key,valid,!1),gen.if((0,codegen_1.not)(valid),()=>{cxt.reset(),deleteAdditional(key)})):(applyAdditionalSchema(key,valid),allErrors||gen.if((0,codegen_1.not)(valid),()=>gen.break()))}}}function applyAdditionalSchema(key,valid,errors){const subschema={keyword:"additionalProperties",dataProp:key,dataPropType:util_1.Type.Str};!1===errors&&Object.assign(subschema,{compositeRule:!0,createErrors:!1,allErrors:!1}),cxt.subschema(subschema,valid)}gen.forIn("key",data,key=>{props.length||patProps.length?gen.if(function(key){let definedProp;if(props.length>8){const propsSchema=(0,util_1.schemaRefOrVal)(it,parentSchema.properties,"properties");definedProp=(0,code_1.isOwnProperty)(gen,propsSchema,key)}else definedProp=props.length?(0,codegen_1.or)(...props.map(p=>codegen_1._`${key} === ${p}`)):codegen_1.nil;return patProps.length&&(definedProp=(0,codegen_1.or)(definedProp,...patProps.map(p=>codegen_1._`${(0,code_1.usePattern)(cxt,p)}.test(${key})`))),(0,codegen_1.not)(definedProp)}(key),()=>additionalPropertyCode(key)):additionalPropertyCode(key)}),cxt.ok(codegen_1._`${errsCount} === ${names_1.default.errors}`)}};return additionalProperties.default=def,additionalProperties}var hasRequiredProperties,hasRequiredPatternProperties,hasRequiredNot,hasRequiredAnyOf,hasRequiredOneOf,hasRequiredAllOf,hasRequired_if,hasRequiredThenElse,hasRequiredApplicator,properties$1={},patternProperties={},not={},anyOf={},oneOf={},allOf={},_if={},thenElse={};function requireApplicator(){if(hasRequiredApplicator)return applicator;hasRequiredApplicator=1,Object.defineProperty(applicator,"__esModule",{value:!0});const additionalItems_1=requireAdditionalItems(),prefixItems_1=function(){if(hasRequiredPrefixItems)return prefixItems;hasRequiredPrefixItems=1,Object.defineProperty(prefixItems,"__esModule",{value:!0});const items_1=requireItems(),def={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:cxt=>(0,items_1.validateTuple)(cxt,"items")};return prefixItems.default=def,prefixItems}(),items_1=requireItems(),items2020_1=function(){if(hasRequiredItems2020)return items2020;hasRequiredItems2020=1,Object.defineProperty(items2020,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),code_1=requireCode(),additionalItems_1=requireAdditionalItems(),def={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:len}})=>codegen_1.str`must NOT have more than ${len} items`,params:({params:{len:len}})=>codegen_1._`{limit: ${len}}`},code(cxt){const{schema:schema,parentSchema:parentSchema,it:it}=cxt,{prefixItems:prefixItems}=parentSchema;it.items=!0,(0,util_1.alwaysValidSchema)(it,schema)||(prefixItems?(0,additionalItems_1.validateAdditionalItems)(cxt,prefixItems):cxt.ok((0,code_1.validateArray)(cxt)))}};return items2020.default=def,items2020}(),contains_1=function(){if(hasRequiredContains)return contains;hasRequiredContains=1,Object.defineProperty(contains,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:min,max:max}})=>void 0===max?codegen_1.str`must contain at least ${min} valid item(s)`:codegen_1.str`must contain at least ${min} and no more than ${max} valid item(s)`,params:({params:{min:min,max:max}})=>void 0===max?codegen_1._`{minContains: ${min}}`:codegen_1._`{minContains: ${min}, maxContains: ${max}}`},code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;let min,max;const{minContains:minContains,maxContains:maxContains}=parentSchema;it.opts.next?(min=void 0===minContains?1:minContains,max=maxContains):min=1;const len=gen.const("len",codegen_1._`${data}.length`);if(cxt.setParams({min:min,max:max}),void 0===max&&0===min)return void(0,util_1.checkStrictMode)(it,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==max&&min>max)return(0,util_1.checkStrictMode)(it,'"minContains" > "maxContains" is always invalid'),void cxt.fail();if((0,util_1.alwaysValidSchema)(it,schema)){let cond=codegen_1._`${len} >= ${min}`;return void 0!==max&&(cond=codegen_1._`${cond} && ${len} <= ${max}`),void cxt.pass(cond)}it.items=!0;const valid=gen.name("valid");function validateItemsWithCount(){const schValid=gen.name("_valid"),count=gen.let("count",0);validateItems(schValid,()=>gen.if(schValid,()=>function(count){gen.code(codegen_1._`${count}++`),void 0===max?gen.if(codegen_1._`${count} >= ${min}`,()=>gen.assign(valid,!0).break()):(gen.if(codegen_1._`${count} > ${max}`,()=>gen.assign(valid,!1).break()),1===min?gen.assign(valid,!0):gen.if(codegen_1._`${count} >= ${min}`,()=>gen.assign(valid,!0)))}(count)))}function validateItems(_valid,block){gen.forRange("i",0,len,i=>{cxt.subschema({keyword:"contains",dataProp:i,dataPropType:util_1.Type.Num,compositeRule:!0},_valid),block()})}void 0===max&&1===min?validateItems(valid,()=>gen.if(valid,()=>gen.break())):0===min?(gen.let(valid,!0),void 0!==max&&gen.if(codegen_1._`${data}.length > 0`,validateItemsWithCount)):(gen.let(valid,!1),validateItemsWithCount()),cxt.result(valid,()=>cxt.reset())}};return contains.default=def,contains}(),dependencies_1=(hasRequiredDependencies||(hasRequiredDependencies=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.validateSchemaDeps=exports.validatePropertyDeps=exports.error=void 0;const codegen_1=requireCodegen(),util_1=requireUtil(),code_1=requireCode();exports.error={message:({params:{property:property,depsCount:depsCount,deps:deps}})=>{const property_ies=1===depsCount?"property":"properties";return codegen_1.str`must have ${property_ies} ${deps} when property ${property} is present`},params:({params:{property:property,depsCount:depsCount,deps:deps,missingProperty:missingProperty}})=>codegen_1._`{property: ${property},
    missingProperty: ${missingProperty},
    depsCount: ${depsCount},
    deps: ${deps}}`};const def={keyword:"dependencies",type:"object",schemaType:"object",error:exports.error,code(cxt){const[propDeps,schDeps]=function({schema:schema}){const propertyDeps={},schemaDeps={};for(const key in schema)"__proto__"!==key&&((Array.isArray(schema[key])?propertyDeps:schemaDeps)[key]=schema[key]);return[propertyDeps,schemaDeps]}(cxt);validatePropertyDeps(cxt,propDeps),validateSchemaDeps(cxt,schDeps)}};function validatePropertyDeps(cxt,propertyDeps=cxt.schema){const{gen:gen,data:data,it:it}=cxt;if(0===Object.keys(propertyDeps).length)return;const missing=gen.let("missing");for(const prop in propertyDeps){const deps=propertyDeps[prop];if(0===deps.length)continue;const hasProperty=(0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties);cxt.setParams({property:prop,depsCount:deps.length,deps:deps.join(", ")}),it.allErrors?gen.if(hasProperty,()=>{for(const depProp of deps)(0,code_1.checkReportMissingProp)(cxt,depProp)}):(gen.if(codegen_1._`${hasProperty} && (${(0,code_1.checkMissingProp)(cxt,deps,missing)})`),(0,code_1.reportMissingProp)(cxt,missing),gen.else())}}function validateSchemaDeps(cxt,schemaDeps=cxt.schema){const{gen:gen,data:data,keyword:keyword,it:it}=cxt,valid=gen.name("valid");for(const prop in schemaDeps)(0,util_1.alwaysValidSchema)(it,schemaDeps[prop])||(gen.if((0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties),()=>{const schCxt=cxt.subschema({keyword:keyword,schemaProp:prop},valid);cxt.mergeValidEvaluated(schCxt,valid)},()=>gen.var(valid,!0)),cxt.ok(valid))}exports.validatePropertyDeps=validatePropertyDeps,exports.validateSchemaDeps=validateSchemaDeps,exports.default=def}(dependencies)),dependencies),propertyNames_1=function(){if(hasRequiredPropertyNames)return propertyNames;hasRequiredPropertyNames=1,Object.defineProperty(propertyNames,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:params})=>codegen_1._`{propertyName: ${params.propertyName}}`},code(cxt){const{gen:gen,schema:schema,data:data,it:it}=cxt;if((0,util_1.alwaysValidSchema)(it,schema))return;const valid=gen.name("valid");gen.forIn("key",data,key=>{cxt.setParams({propertyName:key}),cxt.subschema({keyword:"propertyNames",data:key,dataTypes:["string"],propertyName:key,compositeRule:!0},valid),gen.if((0,codegen_1.not)(valid),()=>{cxt.error(!0),it.allErrors||gen.break()})}),cxt.ok(valid)}};return propertyNames.default=def,propertyNames}(),additionalProperties_1=requireAdditionalProperties(),properties_1=function(){if(hasRequiredProperties)return properties$1;hasRequiredProperties=1,Object.defineProperty(properties$1,"__esModule",{value:!0});const validate_1=requireValidate(),code_1=requireCode(),util_1=requireUtil(),additionalProperties_1=requireAdditionalProperties(),def={keyword:"properties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,data:data,it:it}=cxt;"all"===it.opts.removeAdditional&&void 0===parentSchema.additionalProperties&&additionalProperties_1.default.code(new validate_1.KeywordCxt(it,additionalProperties_1.default,"additionalProperties"));const allProps=(0,code_1.allSchemaProperties)(schema);for(const prop of allProps)it.definedProperties.add(prop);it.opts.unevaluated&&allProps.length&&!0!==it.props&&(it.props=util_1.mergeEvaluated.props(gen,(0,util_1.toHash)(allProps),it.props));const properties=allProps.filter(p=>!(0,util_1.alwaysValidSchema)(it,schema[p]));if(0===properties.length)return;const valid=gen.name("valid");for(const prop of properties)hasDefault(prop)?applyPropertySchema(prop):(gen.if((0,code_1.propertyInData)(gen,data,prop,it.opts.ownProperties)),applyPropertySchema(prop),it.allErrors||gen.else().var(valid,!0),gen.endIf()),cxt.it.definedProperties.add(prop),cxt.ok(valid);function hasDefault(prop){return it.opts.useDefaults&&!it.compositeRule&&void 0!==schema[prop].default}function applyPropertySchema(prop){cxt.subschema({keyword:"properties",schemaProp:prop,dataProp:prop},valid)}}};return properties$1.default=def,properties$1}(),patternProperties_1=function(){if(hasRequiredPatternProperties)return patternProperties;hasRequiredPatternProperties=1,Object.defineProperty(patternProperties,"__esModule",{value:!0});const code_1=requireCode(),codegen_1=requireCodegen(),util_1=requireUtil(),util_2=requireUtil(),def={keyword:"patternProperties",type:"object",schemaType:"object",code(cxt){const{gen:gen,schema:schema,data:data,parentSchema:parentSchema,it:it}=cxt,{opts:opts}=it,patterns=(0,code_1.allSchemaProperties)(schema),alwaysValidPatterns=patterns.filter(p=>(0,util_1.alwaysValidSchema)(it,schema[p]));if(0===patterns.length||alwaysValidPatterns.length===patterns.length&&(!it.opts.unevaluated||!0===it.props))return;const checkProperties=opts.strictSchema&&!opts.allowMatchingProperties&&parentSchema.properties,valid=gen.name("valid");!0===it.props||it.props instanceof codegen_1.Name||(it.props=(0,util_2.evaluatedPropsToName)(gen,it.props));const{props:props}=it;function checkMatchingProperties(pat){for(const prop in checkProperties)new RegExp(pat).test(prop)&&(0,util_1.checkStrictMode)(it,`property ${prop} matches pattern ${pat} (use allowMatchingProperties)`)}function validateProperties(pat){gen.forIn("key",data,key=>{gen.if(codegen_1._`${(0,code_1.usePattern)(cxt,pat)}.test(${key})`,()=>{const alwaysValid=alwaysValidPatterns.includes(pat);alwaysValid||cxt.subschema({keyword:"patternProperties",schemaProp:pat,dataProp:key,dataPropType:util_2.Type.Str},valid),it.opts.unevaluated&&!0!==props?gen.assign(codegen_1._`${props}[${key}]`,!0):alwaysValid||it.allErrors||gen.if((0,codegen_1.not)(valid),()=>gen.break())})})}!function(){for(const pat of patterns)checkProperties&&checkMatchingProperties(pat),it.allErrors?validateProperties(pat):(gen.var(valid,!0),validateProperties(pat),gen.if(valid))}()}};return patternProperties.default=def,patternProperties}(),not_1=function(){if(hasRequiredNot)return not;hasRequiredNot=1,Object.defineProperty(not,"__esModule",{value:!0});const util_1=requireUtil(),def={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if((0,util_1.alwaysValidSchema)(it,schema))return void cxt.fail();const valid=gen.name("valid");cxt.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},valid),cxt.failResult(valid,()=>cxt.reset(),()=>cxt.error())},error:{message:"must NOT be valid"}};return not.default=def,not}(),anyOf_1=function(){if(hasRequiredAnyOf)return anyOf;hasRequiredAnyOf=1,Object.defineProperty(anyOf,"__esModule",{value:!0});const def={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:requireCode().validateUnion,error:{message:"must match a schema in anyOf"}};return anyOf.default=def,anyOf}(),oneOf_1=function(){if(hasRequiredOneOf)return oneOf;hasRequiredOneOf=1,Object.defineProperty(oneOf,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:params})=>codegen_1._`{passingSchemas: ${params.passing}}`},code(cxt){const{gen:gen,schema:schema,parentSchema:parentSchema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");if(it.opts.discriminator&&parentSchema.discriminator)return;const schArr=schema,valid=gen.let("valid",!1),passing=gen.let("passing",null),schValid=gen.name("_valid");cxt.setParams({passing:passing}),gen.block(function(){schArr.forEach((sch,i)=>{let schCxt;(0,util_1.alwaysValidSchema)(it,sch)?gen.var(schValid,!0):schCxt=cxt.subschema({keyword:"oneOf",schemaProp:i,compositeRule:!0},schValid),i>0&&gen.if(codegen_1._`${schValid} && ${valid}`).assign(valid,!1).assign(passing,codegen_1._`[${passing}, ${i}]`).else(),gen.if(schValid,()=>{gen.assign(valid,!0),gen.assign(passing,i),schCxt&&cxt.mergeEvaluated(schCxt,codegen_1.Name)})})}),cxt.result(valid,()=>cxt.reset(),()=>cxt.error(!0))}};return oneOf.default=def,oneOf}(),allOf_1=function(){if(hasRequiredAllOf)return allOf;hasRequiredAllOf=1,Object.defineProperty(allOf,"__esModule",{value:!0});const util_1=requireUtil(),def={keyword:"allOf",schemaType:"array",code(cxt){const{gen:gen,schema:schema,it:it}=cxt;if(!Array.isArray(schema))throw new Error("ajv implementation error");const valid=gen.name("valid");schema.forEach((sch,i)=>{if((0,util_1.alwaysValidSchema)(it,sch))return;const schCxt=cxt.subschema({keyword:"allOf",schemaProp:i},valid);cxt.ok(valid),cxt.mergeEvaluated(schCxt)})}};return allOf.default=def,allOf}(),if_1=function(){if(hasRequired_if)return _if;hasRequired_if=1,Object.defineProperty(_if,"__esModule",{value:!0});const codegen_1=requireCodegen(),util_1=requireUtil(),def={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:params})=>codegen_1.str`must match "${params.ifClause}" schema`,params:({params:params})=>codegen_1._`{failingKeyword: ${params.ifClause}}`},code(cxt){const{gen:gen,parentSchema:parentSchema,it:it}=cxt;void 0===parentSchema.then&&void 0===parentSchema.else&&(0,util_1.checkStrictMode)(it,'"if" without "then" and "else" is ignored');const hasThen=hasSchema(it,"then"),hasElse=hasSchema(it,"else");if(!hasThen&&!hasElse)return;const valid=gen.let("valid",!0),schValid=gen.name("_valid");if(function(){const schCxt=cxt.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},schValid);cxt.mergeEvaluated(schCxt)}(),cxt.reset(),hasThen&&hasElse){const ifClause=gen.let("ifClause");cxt.setParams({ifClause:ifClause}),gen.if(schValid,validateClause("then",ifClause),validateClause("else",ifClause))}else hasThen?gen.if(schValid,validateClause("then")):gen.if((0,codegen_1.not)(schValid),validateClause("else"));function validateClause(keyword,ifClause){return()=>{const schCxt=cxt.subschema({keyword:keyword},schValid);gen.assign(valid,schValid),cxt.mergeValidEvaluated(schCxt,valid),ifClause?gen.assign(ifClause,codegen_1._`${keyword}`):cxt.setParams({ifClause:keyword})}}cxt.pass(valid,()=>cxt.error(!0))}};function hasSchema(it,keyword){const schema=it.schema[keyword];return void 0!==schema&&!(0,util_1.alwaysValidSchema)(it,schema)}return _if.default=def,_if}(),thenElse_1=function(){if(hasRequiredThenElse)return thenElse;hasRequiredThenElse=1,Object.defineProperty(thenElse,"__esModule",{value:!0});const util_1=requireUtil(),def={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:keyword,parentSchema:parentSchema,it:it}){void 0===parentSchema.if&&(0,util_1.checkStrictMode)(it,`"${keyword}" without "if" is ignored`)}};return thenElse.default=def,thenElse}();return applicator.default=function(draft2020=!1){const applicator=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1.default,properties_1.default,patternProperties_1.default];return draft2020?applicator.push(prefixItems_1.default,items2020_1.default):applicator.push(additionalItems_1.default,items_1.default),applicator.push(contains_1.default),applicator},applicator}var hasRequiredFormat$1,hasRequiredFormat,format$1={},format={};function requireFormat$1(){if(hasRequiredFormat$1)return format;hasRequiredFormat$1=1,Object.defineProperty(format,"__esModule",{value:!0});const codegen_1=requireCodegen(),def={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:schemaCode})=>codegen_1.str`must match format "${schemaCode}"`,params:({schemaCode:schemaCode})=>codegen_1._`{format: ${schemaCode}}`},code(cxt,ruleType){const{gen:gen,data:data,$data:$data,schema:schema,schemaCode:schemaCode,it:it}=cxt,{opts:opts,errSchemaPath:errSchemaPath,schemaEnv:schemaEnv,self:self}=it;opts.validateFormats&&($data?function(){const fmts=gen.scopeValue("formats",{ref:self.formats,code:opts.code.formats}),fDef=gen.const("fDef",codegen_1._`${fmts}[${schemaCode}]`),fType=gen.let("fType"),format=gen.let("format");gen.if(codegen_1._`typeof ${fDef} == "object" && !(${fDef} instanceof RegExp)`,()=>gen.assign(fType,codegen_1._`${fDef}.type || "string"`).assign(format,codegen_1._`${fDef}.validate`),()=>gen.assign(fType,codegen_1._`"string"`).assign(format,fDef)),cxt.fail$data((0,codegen_1.or)(!1===opts.strictSchema?codegen_1.nil:codegen_1._`${schemaCode} && !${format}`,function(){const callFormat=schemaEnv.$async?codegen_1._`(${fDef}.async ? await ${format}(${data}) : ${format}(${data}))`:codegen_1._`${format}(${data})`,validData=codegen_1._`(typeof ${format} == "function" ? ${callFormat} : ${format}.test(${data}))`;return codegen_1._`${format} && ${format} !== true && ${fType} === ${ruleType} && !${validData}`}()))}():function(){const formatDef=self.formats[schema];if(!formatDef)return void function(){if(!1!==opts.strictSchema)throw new Error(unknownMsg());function unknownMsg(){return`unknown format "${schema}" ignored in schema at path "${errSchemaPath}"`}self.logger.warn(unknownMsg())}();if(!0===formatDef)return;const[fmtType,format,fmtRef]=function(fmtDef){const code=fmtDef instanceof RegExp?(0,codegen_1.regexpCode)(fmtDef):opts.code.formats?codegen_1._`${opts.code.formats}${(0,codegen_1.getProperty)(schema)}`:void 0,fmt=gen.scopeValue("formats",{key:schema,ref:fmtDef,code:code});return"object"!=typeof fmtDef||fmtDef instanceof RegExp?["string",fmtDef,fmt]:[fmtDef.type||"string",fmtDef.validate,codegen_1._`${fmt}.validate`]}(formatDef);fmtType===ruleType&&cxt.pass(function(){if("object"==typeof formatDef&&!(formatDef instanceof RegExp)&&formatDef.async){if(!schemaEnv.$async)throw new Error("async format in sync schema");return codegen_1._`await ${fmtRef}(${data})`}return"function"==typeof format?codegen_1._`${fmtRef}(${data})`:codegen_1._`${fmtRef}.test(${data})`}())}())}};return format.default=def,format}var hasRequiredMetadata,hasRequiredDraft7,metadata={};function requireDraft7(){if(hasRequiredDraft7)return draft7;hasRequiredDraft7=1,Object.defineProperty(draft7,"__esModule",{value:!0});const core_1=function(){if(hasRequiredCore)return core;hasRequiredCore=1,Object.defineProperty(core,"__esModule",{value:!0});const id_1=function(){if(hasRequiredId)return id;hasRequiredId=1,Object.defineProperty(id,"__esModule",{value:!0});const def={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return id.default=def,id}(),ref_1=function(){if(hasRequiredRef)return ref;hasRequiredRef=1,Object.defineProperty(ref,"__esModule",{value:!0}),ref.callRef=ref.getValidate=void 0;const ref_error_1=requireRef_error(),code_1=requireCode(),codegen_1=requireCodegen(),names_1=requireNames(),compile_1=requireCompile(),util_1=requireUtil(),def={keyword:"$ref",schemaType:"string",code(cxt){const{gen:gen,schema:$ref,it:it}=cxt,{baseId:baseId,schemaEnv:env,validateName:validateName,opts:opts,self:self}=it,{root:root}=env;if(("#"===$ref||"#/"===$ref)&&baseId===root.baseId)return function(){if(env===root)return callRef(cxt,validateName,env,env.$async);const rootName=gen.scopeValue("root",{ref:root});return callRef(cxt,codegen_1._`${rootName}.validate`,root,root.$async)}();const schOrEnv=compile_1.resolveRef.call(self,root,baseId,$ref);if(void 0===schOrEnv)throw new ref_error_1.default(it.opts.uriResolver,baseId,$ref);return schOrEnv instanceof compile_1.SchemaEnv?function(sch){const v=getValidate(cxt,sch);callRef(cxt,v,sch,sch.$async)}(schOrEnv):function(sch){const schName=gen.scopeValue("schema",!0===opts.code.source?{ref:sch,code:(0,codegen_1.stringify)(sch)}:{ref:sch}),valid=gen.name("valid"),schCxt=cxt.subschema({schema:sch,dataTypes:[],schemaPath:codegen_1.nil,topSchemaRef:schName,errSchemaPath:$ref},valid);cxt.mergeEvaluated(schCxt),cxt.ok(valid)}(schOrEnv)}};function getValidate(cxt,sch){const{gen:gen}=cxt;return sch.validate?gen.scopeValue("validate",{ref:sch.validate}):codegen_1._`${gen.scopeValue("wrapper",{ref:sch})}.validate`}function callRef(cxt,v,sch,$async){const{gen:gen,it:it}=cxt,{allErrors:allErrors,schemaEnv:env,opts:opts}=it,passCxt=opts.passContext?names_1.default.this:codegen_1.nil;function addErrorsFrom(source){const errs=codegen_1._`${source}.errors`;gen.assign(names_1.default.vErrors,codegen_1._`${names_1.default.vErrors} === null ? ${errs} : ${names_1.default.vErrors}.concat(${errs})`),gen.assign(names_1.default.errors,codegen_1._`${names_1.default.vErrors}.length`)}function addEvaluatedFrom(source){var _a;if(!it.opts.unevaluated)return;const schEvaluated=null===(_a=null==sch?void 0:sch.validate)||void 0===_a?void 0:_a.evaluated;if(!0!==it.props)if(schEvaluated&&!schEvaluated.dynamicProps)void 0!==schEvaluated.props&&(it.props=util_1.mergeEvaluated.props(gen,schEvaluated.props,it.props));else{const props=gen.var("props",codegen_1._`${source}.evaluated.props`);it.props=util_1.mergeEvaluated.props(gen,props,it.props,codegen_1.Name)}if(!0!==it.items)if(schEvaluated&&!schEvaluated.dynamicItems)void 0!==schEvaluated.items&&(it.items=util_1.mergeEvaluated.items(gen,schEvaluated.items,it.items));else{const items=gen.var("items",codegen_1._`${source}.evaluated.items`);it.items=util_1.mergeEvaluated.items(gen,items,it.items,codegen_1.Name)}}$async?function(){if(!env.$async)throw new Error("async schema referenced by sync schema");const valid=gen.let("valid");gen.try(()=>{gen.code(codegen_1._`await ${(0,code_1.callValidateCode)(cxt,v,passCxt)}`),addEvaluatedFrom(v),allErrors||gen.assign(valid,!0)},e=>{gen.if(codegen_1._`!(${e} instanceof ${it.ValidationError})`,()=>gen.throw(e)),addErrorsFrom(e),allErrors||gen.assign(valid,!1)}),cxt.ok(valid)}():cxt.result((0,code_1.callValidateCode)(cxt,v,passCxt),()=>addEvaluatedFrom(v),()=>addErrorsFrom(v))}return ref.getValidate=getValidate,ref.callRef=callRef,ref.default=def,ref}(),core$1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",id_1.default,ref_1.default];return core.default=core$1,core}(),validation_1=requireValidation(),applicator_1=requireApplicator(),format_1=function(){if(hasRequiredFormat)return format$1;hasRequiredFormat=1,Object.defineProperty(format$1,"__esModule",{value:!0});const format=[requireFormat$1().default];return format$1.default=format,format$1}(),metadata_1=(hasRequiredMetadata||(hasRequiredMetadata=1,Object.defineProperty(metadata,"__esModule",{value:!0}),metadata.contentVocabulary=metadata.metadataVocabulary=void 0,metadata.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],metadata.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),metadata),draft7Vocabularies=[core_1.default,validation_1.default,(0,applicator_1.default)(),format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary];return draft7.default=draft7Vocabularies,draft7}var hasRequiredTypes,hasRequiredDiscriminator,discriminator={},types={};var hasRequiredAjv,require$$3={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};function requireAjv(){return hasRequiredAjv||(hasRequiredAjv=1,function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.MissingRefError=exports.ValidationError=exports.CodeGen=exports.Name=exports.nil=exports.stringify=exports.str=exports._=exports.KeywordCxt=exports.Ajv=void 0;const core_1=requireCore$1(),draft7_1=requireDraft7(),discriminator_1=function(){if(hasRequiredDiscriminator)return discriminator;hasRequiredDiscriminator=1,Object.defineProperty(discriminator,"__esModule",{value:!0});const codegen_1=requireCodegen(),types_1=(hasRequiredTypes||(hasRequiredTypes=1,Object.defineProperty(types,"__esModule",{value:!0}),types.DiscrError=void 0,function(DiscrError){DiscrError.Tag="tag",DiscrError.Mapping="mapping"}(DiscrError||(types.DiscrError=DiscrError={}))),types);var DiscrError;const compile_1=requireCompile(),ref_error_1=requireRef_error(),util_1=requireUtil(),def={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:discrError,tagName:tagName}})=>discrError===types_1.DiscrError.Tag?`tag "${tagName}" must be string`:`value of tag "${tagName}" must be in oneOf`,params:({params:{discrError:discrError,tag:tag,tagName:tagName}})=>codegen_1._`{error: ${discrError}, tag: ${tagName}, tagValue: ${tag}}`},code(cxt){const{gen:gen,data:data,schema:schema,parentSchema:parentSchema,it:it}=cxt,{oneOf:oneOf}=parentSchema;if(!it.opts.discriminator)throw new Error("discriminator: requires discriminator option");const tagName=schema.propertyName;if("string"!=typeof tagName)throw new Error("discriminator: requires propertyName");if(schema.mapping)throw new Error("discriminator: mapping is not supported");if(!oneOf)throw new Error("discriminator: requires oneOf keyword");const valid=gen.let("valid",!1),tag=gen.const("tag",codegen_1._`${data}${(0,codegen_1.getProperty)(tagName)}`);function applyTagSchema(schemaProp){const _valid=gen.name("valid"),schCxt=cxt.subschema({keyword:"oneOf",schemaProp:schemaProp},_valid);return cxt.mergeEvaluated(schCxt,codegen_1.Name),_valid}gen.if(codegen_1._`typeof ${tag} == "string"`,()=>function(){const mapping=function(){var _a;const oneOfMapping={},topRequired=hasRequired(parentSchema);let tagRequired=!0;for(let i=0;i<oneOf.length;i++){let sch=oneOf[i];if((null==sch?void 0:sch.$ref)&&!(0,util_1.schemaHasRulesButRef)(sch,it.self.RULES)){const ref=sch.$ref;if(sch=compile_1.resolveRef.call(it.self,it.schemaEnv.root,it.baseId,ref),sch instanceof compile_1.SchemaEnv&&(sch=sch.schema),void 0===sch)throw new ref_error_1.default(it.opts.uriResolver,it.baseId,ref)}const propSch=null===(_a=null==sch?void 0:sch.properties)||void 0===_a?void 0:_a[tagName];if("object"!=typeof propSch)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${tagName}"`);tagRequired=tagRequired&&(topRequired||hasRequired(sch)),addMappings(propSch,i)}if(!tagRequired)throw new Error(`discriminator: "${tagName}" must be required`);return oneOfMapping;function hasRequired({required:required}){return Array.isArray(required)&&required.includes(tagName)}function addMappings(sch,i){if(sch.const)addMapping(sch.const,i);else{if(!sch.enum)throw new Error(`discriminator: "properties/${tagName}" must have "const" or "enum"`);for(const tagValue of sch.enum)addMapping(tagValue,i)}}function addMapping(tagValue,i){if("string"!=typeof tagValue||tagValue in oneOfMapping)throw new Error(`discriminator: "${tagName}" values must be unique strings`);oneOfMapping[tagValue]=i}}();gen.if(!1);for(const tagValue in mapping)gen.elseIf(codegen_1._`${tag} === ${tagValue}`),gen.assign(valid,applyTagSchema(mapping[tagValue]));gen.else(),cxt.error(!1,{discrError:types_1.DiscrError.Mapping,tag:tag,tagName:tagName}),gen.endIf()}(),()=>cxt.error(!1,{discrError:types_1.DiscrError.Tag,tag:tag,tagName:tagName})),cxt.ok(valid)}};return discriminator.default=def,discriminator}(),draft7MetaSchema=require$$3,META_SUPPORT_DATA=["/properties"],META_SCHEMA_ID="http://json-schema.org/draft-07/schema";class Ajv extends core_1.default{_addVocabularies(){super._addVocabularies(),draft7_1.default.forEach(v=>this.addVocabulary(v)),this.opts.discriminator&&this.addKeyword(discriminator_1.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const metaSchema=this.opts.$data?this.$dataMetaSchema(draft7MetaSchema,META_SUPPORT_DATA):draft7MetaSchema;this.addMetaSchema(metaSchema,META_SCHEMA_ID,!1),this.refs["http://json-schema.org/schema"]=META_SCHEMA_ID}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(META_SCHEMA_ID)?META_SCHEMA_ID:void 0)}}exports.Ajv=Ajv,module.exports=exports=Ajv,module.exports.Ajv=Ajv,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=Ajv;var validate_1=requireValidate();Object.defineProperty(exports,"KeywordCxt",{enumerable:!0,get:function(){return validate_1.KeywordCxt}});var codegen_1=requireCodegen();Object.defineProperty(exports,"_",{enumerable:!0,get:function(){return codegen_1._}}),Object.defineProperty(exports,"str",{enumerable:!0,get:function(){return codegen_1.str}}),Object.defineProperty(exports,"stringify",{enumerable:!0,get:function(){return codegen_1.stringify}}),Object.defineProperty(exports,"nil",{enumerable:!0,get:function(){return codegen_1.nil}}),Object.defineProperty(exports,"Name",{enumerable:!0,get:function(){return codegen_1.Name}}),Object.defineProperty(exports,"CodeGen",{enumerable:!0,get:function(){return codegen_1.CodeGen}});var validation_error_1=requireValidation_error();Object.defineProperty(exports,"ValidationError",{enumerable:!0,get:function(){return validation_error_1.default}});var ref_error_1=requireRef_error();Object.defineProperty(exports,"MissingRefError",{enumerable:!0,get:function(){return ref_error_1.default}})}(ajv$1,ajv$1.exports)),ajv$1.exports}var hasRequiredFormats,hasRequiredLimit,hasRequiredDist$1,hasRequiredDist,Ajv=getDefaultExportFromCjs(requireAjv()),dist$1={exports:{}},formats={},limit={},distExports$1=(hasRequiredDist$1||(hasRequiredDist$1=1,function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});const formats_1=(hasRequiredFormats||(hasRequiredFormats=1,function(exports){function fmtDef(validate,compare){return{validate:validate,compare:compare}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatNames=exports.fastFormats=exports.fullFormats=void 0,exports.fullFormats={date:fmtDef(date,compareDate),time:fmtDef(getTime(!0),compareTime),"date-time":fmtDef(getDateTime(!0),compareDateTime),"iso-time":fmtDef(getTime(),compareIsoTime),"iso-date-time":fmtDef(getDateTime(),compareIsoDateTime),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:function(str){return NOT_URI_FRAGMENT.test(str)&&URI.test(str)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:function(str){if(Z_ANCHOR.test(str))return!1;try{return new RegExp(str),!0}catch(e){return!1}},uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:function(str){return BYTE.lastIndex=0,BYTE.test(str)},int32:{type:"number",validate:function(value){return Number.isInteger(value)&&value<=MAX_INT32&&value>=MIN_INT32}},int64:{type:"number",validate:function(value){return Number.isInteger(value)}},float:{type:"number",validate:validateNumber},double:{type:"number",validate:validateNumber},password:!0,binary:!0},exports.fastFormats={...exports.fullFormats,date:fmtDef(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,compareDate),time:fmtDef(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,compareTime),"date-time":fmtDef(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,compareDateTime),"iso-time":fmtDef(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,compareIsoTime),"iso-date-time":fmtDef(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,compareIsoDateTime),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},exports.formatNames=Object.keys(exports.fullFormats);const DATE=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,DAYS=[0,31,28,31,30,31,30,31,31,30,31,30,31];function date(str){const matches=DATE.exec(str);if(!matches)return!1;const year=+matches[1],month=+matches[2],day=+matches[3];return month>=1&&month<=12&&day>=1&&day<=(2===month&&function(year){return year%4==0&&(year%100!=0||year%400==0)}(year)?29:DAYS[month])}function compareDate(d1,d2){if(d1&&d2)return d1>d2?1:d1<d2?-1:0}const TIME=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function getTime(strictTimeZone){return function(str){const matches=TIME.exec(str);if(!matches)return!1;const hr=+matches[1],min=+matches[2],sec=+matches[3],tz=matches[4],tzSign="-"===matches[5]?-1:1,tzH=+(matches[6]||0),tzM=+(matches[7]||0);if(tzH>23||tzM>59||strictTimeZone&&!tz)return!1;if(hr<=23&&min<=59&&sec<60)return!0;const utcMin=min-tzM*tzSign,utcHr=hr-tzH*tzSign-(utcMin<0?1:0);return(23===utcHr||-1===utcHr)&&(59===utcMin||-1===utcMin)&&sec<61}}function compareTime(s1,s2){if(!s1||!s2)return;const t1=new Date("2020-01-01T"+s1).valueOf(),t2=new Date("2020-01-01T"+s2).valueOf();return t1&&t2?t1-t2:void 0}function compareIsoTime(t1,t2){if(!t1||!t2)return;const a1=TIME.exec(t1),a2=TIME.exec(t2);return a1&&a2?(t1=a1[1]+a1[2]+a1[3])>(t2=a2[1]+a2[2]+a2[3])?1:t1<t2?-1:0:void 0}const DATE_TIME_SEPARATOR=/t|\s/i;function getDateTime(strictTimeZone){const time=getTime(strictTimeZone);return function(str){const dateTime=str.split(DATE_TIME_SEPARATOR);return 2===dateTime.length&&date(dateTime[0])&&time(dateTime[1])}}function compareDateTime(dt1,dt2){if(!dt1||!dt2)return;const d1=new Date(dt1).valueOf(),d2=new Date(dt2).valueOf();return d1&&d2?d1-d2:void 0}function compareIsoDateTime(dt1,dt2){if(!dt1||!dt2)return;const[d1,t1]=dt1.split(DATE_TIME_SEPARATOR),[d2,t2]=dt2.split(DATE_TIME_SEPARATOR),res=compareDate(d1,d2);return void 0!==res?res||compareTime(t1,t2):void 0}const NOT_URI_FRAGMENT=/\/|:/,URI=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,BYTE=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm,MIN_INT32=-2147483648,MAX_INT32=2**31-1;function validateNumber(){return!0}const Z_ANCHOR=/[^\\]\\Z/}(formats)),formats),limit_1=(hasRequiredLimit||(hasRequiredLimit=1,function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatLimitDefinition=void 0;const ajv_1=requireAjv(),codegen_1=requireCodegen(),ops=codegen_1.operators,KWDs={formatMaximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},formatMinimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},formatExclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},formatExclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}},error={message:({keyword:keyword,schemaCode:schemaCode})=>codegen_1.str`should be ${KWDs[keyword].okStr} ${schemaCode}`,params:({keyword:keyword,schemaCode:schemaCode})=>codegen_1._`{comparison: ${KWDs[keyword].okStr}, limit: ${schemaCode}}`};exports.formatLimitDefinition={keyword:Object.keys(KWDs),type:"string",schemaType:"string",$data:!0,error:error,code(cxt){const{gen:gen,data:data,schemaCode:schemaCode,keyword:keyword,it:it}=cxt,{opts:opts,self:self}=it;if(!opts.validateFormats)return;const fCxt=new ajv_1.KeywordCxt(it,self.RULES.all.format.definition,"format");function compareCode(fmt){return codegen_1._`${fmt}.compare(${data}, ${schemaCode}) ${KWDs[keyword].fail} 0`}fCxt.$data?function(){const fmts=gen.scopeValue("formats",{ref:self.formats,code:opts.code.formats}),fmt=gen.const("fmt",codegen_1._`${fmts}[${fCxt.schemaCode}]`);cxt.fail$data((0,codegen_1.or)(codegen_1._`typeof ${fmt} != "object"`,codegen_1._`${fmt} instanceof RegExp`,codegen_1._`typeof ${fmt}.compare != "function"`,compareCode(fmt)))}():function(){const format=fCxt.schema,fmtDef=self.formats[format];if(!fmtDef||!0===fmtDef)return;if("object"!=typeof fmtDef||fmtDef instanceof RegExp||"function"!=typeof fmtDef.compare)throw new Error(`"${keyword}": format "${format}" does not define "compare" function`);const fmt=gen.scopeValue("formats",{key:format,ref:fmtDef,code:opts.code.formats?codegen_1._`${opts.code.formats}${(0,codegen_1.getProperty)(format)}`:void 0});cxt.fail$data(compareCode(fmt))}()},dependencies:["format"]},exports.default=ajv=>(ajv.addKeyword(exports.formatLimitDefinition),ajv)}(limit)),limit),codegen_1=requireCodegen(),fullName=new codegen_1.Name("fullFormats"),fastName=new codegen_1.Name("fastFormats"),formatsPlugin=(ajv,opts={keywords:!0})=>{if(Array.isArray(opts))return addFormats(ajv,opts,formats_1.fullFormats,fullName),ajv;const[formats,exportName]="fast"===opts.mode?[formats_1.fastFormats,fastName]:[formats_1.fullFormats,fullName];return addFormats(ajv,opts.formats||formats_1.formatNames,formats,exportName),opts.keywords&&(0,limit_1.default)(ajv),ajv};function addFormats(ajv,list,fs,exportName){var _a,_b;null!==(_a=(_b=ajv.opts.code).formats)&&void 0!==_a||(_b.formats=codegen_1._`require("ajv-formats/dist/formats").${exportName}`);for(const f of list)ajv.addFormat(f,fs[f])}formatsPlugin.get=(name,mode="full")=>{const f=("fast"===mode?formats_1.fastFormats:formats_1.fullFormats)[name];if(!f)throw new Error(`Unknown format "${name}"`);return f},module.exports=exports=formatsPlugin,Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=formatsPlugin}(dist$1,dist$1.exports)),dist$1.exports),addFormats=getDefaultExportFromCjs(distExports$1),dist={exports:{}},distExports=(hasRequiredDist||(hasRequiredDist=1,function(module,exports){Object.defineProperty(exports,"__esModule",{value:!0});const ajv_1=requireAjv(),codegen_1=requireCodegen(),code_1=requireCode$1(),validate_1=requireValidate(),errors_1=requireErrors(),names_1=requireNames(),keyword="errorMessage",used=new ajv_1.Name("emUsed"),KEYWORD_PROPERTY_PARAMS={required:"missingProperty",dependencies:"property",dependentRequired:"property"},INTERPOLATION=/\$\{[^}]+\}/,INTERPOLATION_REPLACE=/\$\{([^}]+)\}/g,EMPTY_STR=/^""\s*\+\s*|\s*\+\s*""$/g;const ajvErrors=(ajv,options={})=>{if(!ajv.opts.allErrors)throw new Error("ajv-errors: Ajv option allErrors must be true");if(ajv.opts.jsPropertySyntax)throw new Error("ajv-errors: ajv option jsPropertySyntax is not supported");return ajv.addKeyword(function(options){return{keyword:keyword,schemaType:["string","object"],post:!0,code(cxt){const{gen:gen,data:data,schema:schema,schemaValue:schemaValue,it:it}=cxt;if(!1===it.createErrors)return;const sch=schema,instancePath=codegen_1.strConcat(names_1.default.instancePath,it.errorPath);function matchKeywordError(err,kwdErrs){return codegen_1.and(ajv_1._`${err}.keyword !== ${keyword}`,ajv_1._`!${err}.${used}`,ajv_1._`${err}.instancePath === ${instancePath}`,ajv_1._`${err}.keyword in ${kwdErrs}`,ajv_1._`${err}.schemaPath.indexOf(${it.errSchemaPath}) === 0`,ajv_1._`/^\\/[^\\/]*$/.test(${err}.schemaPath.slice(${it.errSchemaPath.length}))`)}function getTemplatesCode(keys,msgs){const templatesCode=[];for(const k in keys){const msg=msgs[k];INTERPOLATION.test(msg)&&templatesCode.push([k,templateFunc(msg)])}return gen.object(...templatesCode)}function templateExpr(msg){return INTERPOLATION.test(msg)?new code_1._Code(code_1.safeStringify(msg).replace(INTERPOLATION_REPLACE,(_s,ptr)=>`" + JSON.stringify(${validate_1.getData(ptr,it)}) + "`).replace(EMPTY_STR,"")):ajv_1.stringify(msg)}function templateFunc(msg){return ajv_1._`function(){return ${templateExpr(msg)}}`}gen.if(ajv_1._`${names_1.default.errors} > 0`,()=>{if("object"==typeof sch){const[kwdPropErrors,kwdErrors]=function(emSchema){let propErrors,errors;for(const k in emSchema){if("properties"===k||"items"===k)continue;const kwdSch=emSchema[k];if("object"==typeof kwdSch){propErrors||(propErrors={});const errMap=propErrors[k]={};for(const p in kwdSch)errMap[p]=[]}else errors||(errors={}),errors[k]=[]}return[propErrors,errors]}(sch);kwdErrors&&function(kwdErrors){const kwdErrs=gen.const("emErrors",ajv_1.stringify(kwdErrors)),templates=gen.const("templates",getTemplatesCode(kwdErrors,schema));gen.forOf("err",names_1.default.vErrors,err=>gen.if(matchKeywordError(err,kwdErrs),()=>gen.code(ajv_1._`${kwdErrs}[${err}.keyword].push(${err})`).assign(ajv_1._`${err}.${used}`,!0)));const{singleError:singleError}=options;if(singleError){const message=gen.let("message",ajv_1._`""`),paramsErrors=gen.let("paramsErrors",ajv_1._`[]`);loopErrors(key=>{gen.if(message,()=>gen.code(ajv_1._`${message} += ${"string"==typeof singleError?singleError:";"}`)),gen.code(ajv_1._`${message} += ${errMessage(key)}`),gen.assign(paramsErrors,ajv_1._`${paramsErrors}.concat(${kwdErrs}[${key}])`)}),errors_1.reportError(cxt,{message:message,params:ajv_1._`{errors: ${paramsErrors}}`})}else loopErrors(key=>errors_1.reportError(cxt,{message:errMessage(key),params:ajv_1._`{errors: ${kwdErrs}[${key}]}`}));function loopErrors(body){gen.forIn("key",kwdErrs,key=>gen.if(ajv_1._`${kwdErrs}[${key}].length`,()=>body(key)))}function errMessage(key){return ajv_1._`${key} in ${templates} ? ${templates}[${key}]() : ${schemaValue}[${key}]`}}(kwdErrors),kwdPropErrors&&function(kwdPropErrors){const kwdErrs=gen.const("emErrors",ajv_1.stringify(kwdPropErrors)),templatesCode=[];for(const k in kwdPropErrors)templatesCode.push([k,getTemplatesCode(kwdPropErrors[k],schema[k])]);const templates=gen.const("templates",gen.object(...templatesCode)),kwdPropParams=gen.scopeValue("obj",{ref:KEYWORD_PROPERTY_PARAMS,code:ajv_1.stringify(KEYWORD_PROPERTY_PARAMS)}),propParam=gen.let("emPropParams"),paramsErrors=gen.let("emParamsErrors");gen.forOf("err",names_1.default.vErrors,err=>gen.if(matchKeywordError(err,kwdErrs),()=>{gen.assign(propParam,ajv_1._`${kwdPropParams}[${err}.keyword]`),gen.assign(paramsErrors,ajv_1._`${kwdErrs}[${err}.keyword][${err}.params[${propParam}]]`),gen.if(paramsErrors,()=>gen.code(ajv_1._`${paramsErrors}.push(${err})`).assign(ajv_1._`${err}.${used}`,!0))})),gen.forIn("key",kwdErrs,key=>gen.forIn("keyProp",ajv_1._`${kwdErrs}[${key}]`,keyProp=>{gen.assign(paramsErrors,ajv_1._`${kwdErrs}[${key}][${keyProp}]`),gen.if(ajv_1._`${paramsErrors}.length`,()=>{const tmpl=gen.const("tmpl",ajv_1._`${templates}[${key}] && ${templates}[${key}][${keyProp}]`);errors_1.reportError(cxt,{message:ajv_1._`${tmpl} ? ${tmpl}() : ${schemaValue}[${key}][${keyProp}]`,params:ajv_1._`{errors: ${paramsErrors}}`})})}))}(kwdPropErrors),function(childErrors){const{props:props,items:items}=childErrors;if(!props&&!items)return;const isObj=ajv_1._`typeof ${data} == "object"`,isArr=ajv_1._`Array.isArray(${data})`,childErrs=gen.let("emErrors");let childKwd,childProp;const templates=gen.let("templates");function init(children,msgs){gen.assign(childErrs,ajv_1.stringify(children)),gen.assign(templates,getTemplatesCode(children,msgs))}props&&items?(childKwd=gen.let("emChildKwd"),gen.if(isObj),gen.if(isArr,()=>{init(items,schema.items),gen.assign(childKwd,ajv_1.str`items`)},()=>{init(props,schema.properties),gen.assign(childKwd,ajv_1.str`properties`)}),childProp=ajv_1._`[${childKwd}]`):items?(gen.if(isArr),init(items,schema.items),childProp=ajv_1._`.items`):props&&(gen.if(codegen_1.and(isObj,codegen_1.not(isArr))),init(props,schema.properties),childProp=ajv_1._`.properties`),gen.forOf("err",names_1.default.vErrors,err=>function(err,childErrs,thenBody){gen.if(codegen_1.and(ajv_1._`${err}.keyword !== ${keyword}`,ajv_1._`!${err}.${used}`,ajv_1._`${err}.instancePath.indexOf(${instancePath}) === 0`),()=>{const childRegex=gen.scopeValue("pattern",{ref:/^\/([^/]*)(?:\/|$)/,code:ajv_1._`new RegExp("^\\\/([^/]*)(?:\\\/|$)")`}),matches=gen.const("emMatches",ajv_1._`${childRegex}.exec(${err}.instancePath.slice(${instancePath}.length))`),child=gen.const("emChild",ajv_1._`${matches} && ${matches}[1].replace(/~1/g, "/").replace(/~0/g, "~")`);gen.if(ajv_1._`${child} !== undefined && ${child} in ${childErrs}`,()=>thenBody(child))})}(err,childErrs,child=>gen.code(ajv_1._`${childErrs}[${child}].push(${err})`).assign(ajv_1._`${err}.${used}`,!0))),gen.forIn("key",childErrs,key=>gen.if(ajv_1._`${childErrs}[${key}].length`,()=>{errors_1.reportError(cxt,{message:ajv_1._`${key} in ${templates} ? ${templates}[${key}]() : ${schemaValue}${childProp}[${key}]`,params:ajv_1._`{errors: ${childErrs}[${key}]}`}),gen.assign(ajv_1._`${names_1.default.vErrors}[${names_1.default.errors}-1].instancePath`,ajv_1._`${instancePath} + "/" + ${key}.replace(/~/g, "~0").replace(/\\//g, "~1")`)})),gen.endIf()}(function({properties:properties,items:items}){const errors={};if(properties){errors.props={};for(const p in properties)errors.props[p]=[]}if(items){errors.items={};for(let i=0;i<items.length;i++)errors.items[i]=[]}return errors}(sch))}const schMessage="string"==typeof sch?sch:sch._;schMessage&&function(schMessage){const errs=gen.const("emErrs",ajv_1._`[]`);gen.forOf("err",names_1.default.vErrors,err=>gen.if(function(err){return codegen_1.and(ajv_1._`${err}.keyword !== ${keyword}`,ajv_1._`!${err}.${used}`,codegen_1.or(ajv_1._`${err}.instancePath === ${instancePath}`,codegen_1.and(ajv_1._`${err}.instancePath.indexOf(${instancePath}) === 0`,ajv_1._`${err}.instancePath[${instancePath}.length] === "/"`)),ajv_1._`${err}.schemaPath.indexOf(${it.errSchemaPath}) === 0`,ajv_1._`${err}.schemaPath[${it.errSchemaPath}.length] === "/"`)}(err),()=>gen.code(ajv_1._`${errs}.push(${err})`).assign(ajv_1._`${err}.${used}`,!0))),gen.if(ajv_1._`${errs}.length`,()=>errors_1.reportError(cxt,{message:templateExpr(schMessage),params:ajv_1._`{errors: ${errs}}`}))}(schMessage),options.keepErrors||function(){const errs=gen.const("emErrs",ajv_1._`[]`);gen.forOf("err",names_1.default.vErrors,err=>gen.if(ajv_1._`!${err}.${used}`,()=>gen.code(ajv_1._`${errs}.push(${err})`))),gen.assign(names_1.default.vErrors,errs).assign(names_1.default.errors,ajv_1._`${errs}.length`)}()})},metaSchema:{anyOf:[{type:"string"},{type:"object",properties:{properties:{$ref:"#/$defs/stringMap"},items:{$ref:"#/$defs/stringList"},required:{$ref:"#/$defs/stringOrMap"},dependencies:{$ref:"#/$defs/stringOrMap"}},additionalProperties:{type:"string"}}],$defs:{stringMap:{type:"object",additionalProperties:{type:"string"}},stringOrMap:{anyOf:[{type:"string"},{$ref:"#/$defs/stringMap"}]},stringList:{type:"array",items:{type:"string"}}}}}}(options))};exports.default=ajvErrors,module.exports=ajvErrors,module.exports.default=ajvErrors}(dist,dist.exports)),dist.exports),addErrors=getDefaultExportFromCjs(distExports);const ajv=new Ajv({allErrors:!0,$data:!0,validateSchema:!0,validateFormats:!0,strictSchema:!1,strict:!1,messages:!0});ajv.addFormat("email",/^(?!.*[.]{2})[a-zA-Z0-9](?:[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]*[a-zA-Z0-9])?@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*\.[a-zA-Z]{2,}$/i),addFormats(ajv,{mode:"fast",formats:["date","time","uri"],keywords:!0}),addErrors(ajv),"undefined"!=typeof window&&(window.schemaParser=ajv),exports.schemaParser=ajv});