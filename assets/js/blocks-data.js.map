{"version":3,"file":"blocks-data.js","sources":["../../src/js/data/query-state/constants.js","../../src/js/data/query-state/utils.js","../../src/js/data/query-state/selectors.js","../../src/js/data/query-state/action-types.js","../../src/js/data/query-state/actions.js","../../src/js/data/query-state/reducers.js","../../src/js/data/query-state/index.js"],"sourcesContent":["export const STORE_KEY = 'strt/store/query-state';\n","export const getStateForContext = (state, context) => {\n  return typeof state[context] === 'undefined' ? null : state[context]\n}\n","import { getStateForContext } from './utils.js'\n\n/**\n * Селектор для получения определённого состояния запроса для заданного контекста.\n *\n * @param {Object} state Текущее состояние.\n * @param {string} context Контекст для извлекаемого состояния запроса.\n * @param {string} queryKey Ключ для определённого элемента состояния запроса.\n * @param {*} defaultValue Значение по умолчанию для ключа состояния запроса, если оно в данный момент\n * отсутствует в состоянии.\n *\n * @return {*} Текущее сохранённое значение или defaultValue, если оно отсутствует.\n */\nexport const getValueForQueryKey = (\n  state,\n  context,\n  queryKey,\n  defaultValue = {},\n) => {\n  let stateContext = getStateForContext(state, context)\n\n  if (stateContext === null) {\n    return defaultValue\n  }\n\n  stateContext = JSON.parse(stateContext)\n\n  return typeof stateContext[queryKey] !== 'undefined' ? stateContext[queryKey] : defaultValue\n}\n\n/**\n * Селектор для получения состояния запроса для заданного контекста.\n *\n * @param {Object} state Текущее состояние.\n * @param {string} context Контекст для извлекаемого состояния запроса.\n * @param {*} defaultValue Значение по умолчанию, возвращаемое, если для\n * заданного контекста состояние отсутствует.\n *\n * @return {*} Текущее сохранённое состояние запроса для заданного контекста или\n * defaultValue, если отсутствует в состоянии.\n */\nexport const getValueForQueryContext = (\n  state,\n  context,\n  defaultValue = {},\n) => {\n  const stateContext = getStateForContext(state, context)\n\n  return stateContext === null ? defaultValue : JSON.parse(stateContext)\n}\n","export const ACTION_TYPES = {\n  SET_QUERY_KEY_VALUE    : 'SET_QUERY_KEY_VALUE',\n  SET_QUERY_CONTEXT_VALUE: 'SET_QUERY_CONTEXT_VALUE',\n}\n","import { ACTION_TYPES as types } from './action-types.js'\n\n/**\n * Создатель действия для установки одного значения состояния запроса для заданного контекста.\n *\n * @param {string} context Контекст для сохраняемого состояния запроса.\n * @param {string} queryKey Ключ для элемента запроса.\n * @param {*} value Значение элемента запроса.\n *\n * @return {Object} Объект действия.\n */\nexport const setQueryValue = (context, queryKey, value) => {\n  return {\n    type: types.SET_QUERY_KEY_VALUE,\n    context,\n    queryKey,\n    value,\n  }\n}\n\n/**\n * Создатель действия для установки состояния запроса для заданного контекста.\n *\n * @param {string} context Контекст для сохраняемого состояния запроса.\n * @param {*} value Состояние запроса, сохраняемое для заданного контекста.\n *\n * @return {Object} Объект действия.\n */\nexport const setValueForQueryContext = (context, value) => {\n  return {\n    type: types.SET_QUERY_CONTEXT_VALUE,\n    context,\n    value,\n  }\n}\n","import { ACTION_TYPES as types } from './action-types.js'\r\nimport { getStateForContext } from './utils.js'\r\n\r\n/**\r\n * Редуктор для обработки действий, связанных с хранилищем состояний запроса.\r\n *\r\n * @param {Object} state Текущее состояние в хранилище.\r\n * @param {Object} action Действие, которое обрабатывается.\r\n */\r\nconst queryStateReducer = (state = {}, action) => {\r\n  const { type, context, queryKey, value } = action\r\n  const prevState = getStateForContext(state, context)\r\n  let newState\r\n\r\n  switch (type) {\r\n    case types.SET_QUERY_KEY_VALUE:\r\n      const prevStateObject = prevState !== null ? JSON.parse(prevState) : {}\r\n\r\n      prevStateObject[queryKey] = value\r\n      newState = JSON.stringify(prevStateObject)\r\n\r\n      if (prevState !== newState) {\r\n        state = { ...state, [context]: newState }\r\n      }\r\n      break\r\n    case types.SET_QUERY_CONTEXT_VALUE:\r\n      newState = JSON.stringify(value)\r\n\r\n      if (prevState !== newState) {\r\n        state = { ...state, [context]: newState }\r\n      }\r\n      break\r\n  }\r\n  return state\r\n}\r\n\r\nexport default queryStateReducer\r\n","import { register, createReduxStore } from '@wordpress/data'\r\n\r\nimport { STORE_KEY } from './constants.js'\r\nimport * as selectors from './selectors.js'\r\nimport * as actions from './actions.js'\r\nimport reducer from './reducers.js'\r\n\r\nconst config = {\r\n  reducer,\r\n  actions,\r\n  selectors,\r\n}\r\n\r\nexport const store = createReduxStore(STORE_KEY, config)\r\n\r\nregister(store)\r\n\r\nexport const QUERY_STATE_STORE_KEY = STORE_KEY"],"names":["STORE_KEY","getStateForContext","state","context","getValueForQueryKey","queryKey","defaultValue","arguments","length","undefined","stateContext","JSON","parse","getValueForQueryContext","ACTION_TYPES","SET_QUERY_KEY_VALUE","SET_QUERY_CONTEXT_VALUE","setQueryValue","value","type","types","setValueForQueryContext","queryStateReducer","action","prevState","newState","prevStateObject","stringify","config","reducer","actions","selectors","store","createReduxStore","register","QUERY_STATE_STORE_KEY"],"mappings":"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"}